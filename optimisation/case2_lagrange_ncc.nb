(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49296,       1311]
NotebookOptionsPosition[     43909,       1211]
NotebookOutlinePosition[     44398,       1228]
CellTagsIndexPosition[     44355,       1225]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Computations on case 2  with Lagrange Multipliers\n", "Title"],
 StyleBox["Fixed sample sizes in period 1 and 2 with ncc, assuming 1:1 in \
period 1\n", "Subtitle"],
 "\n",
 StyleBox["Set (and simplify) conditions", "Section"]
}], "Text",
 CellChangeTimes->{{3.8563248189079075`*^9, 3.8563248504343576`*^9}, 
   3.8563248902348986`*^9, {3.856330074429706*^9, 3.856330078818722*^9}, 
   3.8563370227953105`*^9, {3.8563372343766155`*^9, 3.8563372366380224`*^9}, {
   3.8563453867999697`*^9, 3.8563453869555535`*^9}, 3.8564100206668825`*^9, {
   3.856410848876874*^9, 3.8564108600815997`*^9}, {3.8564109754713287`*^9, 
   3.8564109814042797`*^9}, {3.8564389001077924`*^9, 3.856438907711238*^9}, {
   3.856583700185769*^9, 3.85658370563993*^9}, {3.863063082059705*^9, 
   3.86306308320924*^9}, {3.865914651242138*^9, 
   3.8659146655835557`*^9}},ExpressionUUID->"f7ba8136-f710-4688-b231-\
5d7e388e68b5"],

Cell["\<\
Note that here we assume r1+r2=1, then r3=0. Furthermore, we assume 1:1 \
allocation in period 1. \
\>", "Text",
 CellChangeTimes->{{3.8630639723949313`*^9, 3.8630639863899665`*^9}, {
  3.865914326955559*^9, 
  3.865914337194724*^9}},ExpressionUUID->"7e7f6402-700e-4c0c-a04d-\
6f80a5a1effe"],

Cell[CellGroupData[{

Cell["\<\
subst = {r11 -> r1/2 , r01 -> r1/2 , r02 -> (1 - r1) - r12 - r22 }\
\>", "Input",
 CellChangeTimes->{{3.856241055409762*^9, 3.8562410574112105`*^9}, {
   3.8562410945331097`*^9, 3.8562411481989813`*^9}, {3.8562413942892437`*^9, 
   3.8562413985865993`*^9}, {3.8563191337338676`*^9, 3.85631916052186*^9}, {
   3.8563191921179976`*^9, 3.8563192853897457`*^9}, {3.8563452700840726`*^9, 
   3.8563453390757713`*^9}, 3.856345499874628*^9, {3.856516757266733*^9, 
   3.856516972892971*^9}, {3.856517017501582*^9, 3.8565171185973473`*^9}, {
   3.8565175862464113`*^9, 3.856517595618346*^9}, {3.856539052929823*^9, 
   3.856539107495953*^9}, {3.8565395177692013`*^9, 3.856539584987108*^9}, {
   3.856540156475342*^9, 3.856540159429785*^9}, {3.8565437359378138`*^9, 
   3.856543740493415*^9}, {3.863060770327691*^9, 3.8630607730953264`*^9}, {
   3.8630626748433175`*^9, 3.863062719248189*^9}, {3.8630627853478117`*^9, 
   3.8630628137481885`*^9}, {3.863070955716105*^9, 3.863070966087571*^9}, {
   3.863072616927348*^9, 3.863072637244659*^9}, {3.863072672245171*^9, 
   3.863072673279481*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"a2d3e9a1-2d98-42bd-bb2c-c44d17fc2dab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r11", "\[Rule]", 
    FractionBox["r1", "2"]}], ",", 
   RowBox[{"r01", "\[Rule]", 
    FractionBox["r1", "2"]}], ",", 
   RowBox[{"r02", "\[Rule]", 
    RowBox[{"1", "-", "r1", "-", "r12", "-", "r22"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.856345341120479*^9, 3.856345417943179*^9, 3.856345557495439*^9, 
   3.8563468656544356`*^9, 3.8563479340129957`*^9, 3.856348976391008*^9, 
   3.8563492610507402`*^9, 3.8563493138979197`*^9, 3.856349526953724*^9, 
   3.8563496119239902`*^9, 3.8563498775338736`*^9, 3.856349979158541*^9, 
   3.8563503622057085`*^9, 3.8563507089595003`*^9, 3.8563508588114605`*^9, 
   3.8564087194079123`*^9, 3.8564087790954547`*^9, 3.856408930588065*^9, 
   3.856410016796308*^9, 3.8564103157935696`*^9, 3.8564134726059523`*^9, 
   3.8564389736592846`*^9, 3.856439093237759*^9, 3.8564392965226035`*^9, {
   3.85651614693049*^9, 3.856516158647295*^9}, 3.856516301219244*^9, 
   3.856516350405014*^9, 3.856516651399624*^9, 3.856516740794113*^9, 
   3.8565168818170156`*^9, 3.85651700125427*^9, {3.856517050741248*^9, 
   3.85651706267929*^9}, 3.8565171352004757`*^9, 3.856517599865177*^9, 
   3.856518152002685*^9, 3.85653811906147*^9, 3.8565391087257643`*^9, 
   3.856539470869729*^9, 3.856539587710862*^9, 3.856540160693152*^9, 
   3.856541332411271*^9, 3.856543742054805*^9, 3.856544234410069*^9, 
   3.856580095132256*^9, 3.8565833249451847`*^9, 3.8565868819438267`*^9, 
   3.863060775601389*^9, 3.863061016818715*^9, 3.863061092355994*^9, 
   3.8630612645811253`*^9, {3.8630626943862033`*^9, 3.863062719818668*^9}, 
   3.863062814371525*^9, 3.863062954787525*^9, 3.86306308862023*^9, 
   3.8630634059725075`*^9, 3.863063904901929*^9, 3.8630642615846024`*^9, 
   3.863070333962764*^9, 3.863070744111249*^9, 3.8630709684708443`*^9, 
   3.8630723812844133`*^9, 3.863072638719988*^9, 3.863072674177104*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"7a9f604e-277a-437c-85cd-bfefd7689931"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ex", "=", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", "0.4"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.856583265382502*^9, 3.8565833136007233`*^9}, {
  3.8630703225370717`*^9, 3.8630703247491584`*^9}, {3.8630709720955343`*^9, 
  3.863070972972464*^9}, {3.8630714194532146`*^9, 3.863071421556571*^9}, {
  3.8630724649587727`*^9, 3.863072467770565*^9}, {3.863072642915594*^9, 
  3.863072643995078*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"df82f182-6836-4609-9fbb-300ae0505d73"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"r1", "\[Rule]", "0.4`"}], "}"}]], "Output",
 CellChangeTimes->{3.863071422249804*^9, 3.8630723829195023`*^9, 
  3.86307246850659*^9, 3.8630726446527557`*^9, 3.863072675326749*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"e9fc5f0c-4c36-472f-80a8-f2e74008b3d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exb", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r12", "\[Rule]", "0"}], ",", 
    RowBox[{"r22", "\[Rule]", 
     RowBox[{"r2", "/", "2"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.863071033677803*^9, 3.8630711164106207`*^9}, {
  3.863071462574449*^9, 3.863071482340769*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"1b44415d-5a73-4b50-8680-1efc9d312751"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r12", "\[Rule]", "0"}], ",", 
   RowBox[{"r22", "\[Rule]", 
    FractionBox["r2", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.863071111396036*^9, 3.8630711169939537`*^9}, 
   3.863071483473611*^9, 3.863072383754006*^9, 3.8630724696822767`*^9, 
   3.86307264640306*^9, 3.863072676866461*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"64bf9970-7e04-4e01-b1ac-78557d67a4c3"]
}, Open  ]],

Cell[TextData[{
 StyleBox["\[LineSeparator]Define terms to optimise", "Section"],
 "\nNote: ",
 StyleBox["sigma*term1^(-1)/N",
  FontSlant->"Italic"],
 " is the variance of the estimator of effect 1 (analogously ",
 StyleBox["sigma*term2^(-1)/N",
  FontSlant->"Italic"],
 " for effect 2). But since sigma and N are fixed, we simply work on term1 \
and term2 expressions."
}], "Text",
 CellChangeTimes->{{3.856324859103889*^9, 3.8563248655216613`*^9}, {
   3.8563249258313665`*^9, 3.8563250321024923`*^9}, {3.856325108777877*^9, 
   3.856325130602702*^9}, 3.8563302435635047`*^9, 3.856516355919116*^9, {
   3.85651921805399*^9, 3.856519226041996*^9}, 
   3.865914324753704*^9},ExpressionUUID->"54ff16e6-289c-48e2-962e-\
d9bff39fa4b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r11", "*", 
       RowBox[{"r01", "/", 
        RowBox[{"(", 
         RowBox[{"r11", "+", "r01"}], ")"}]}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"r12", "*", 
       RowBox[{"r02", "/", 
        RowBox[{"(", 
         RowBox[{"r12", "+", "r02"}], ")"}]}]}], ")"}]}], "/.", "subst"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8563246032441535`*^9, 3.856324603752307*^9}, {
   3.856324922372285*^9, 3.856324923755909*^9}, 3.856325158114187*^9, 
   3.856349004221649*^9, {3.856517188216709*^9, 3.856517192130351*^9}, {
   3.8565173388817368`*^9, 3.856517343561132*^9}, {3.856517928451528*^9, 
   3.85651793191536*^9}, {3.856539599520781*^9, 3.8565396008858337`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"c76aa63c-8ff6-4e2d-a363-ca301193fbd0"],

Cell[BoxData[
 RowBox[{
  FractionBox["r1", "4"], "+", "r12", "+", 
  FractionBox[
   SuperscriptBox["r12", "2"], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "r1", "+", "r22"}]]}]], "Output",
 CellChangeTimes->{
  3.8563278613553805`*^9, 3.8563282707941904`*^9, 3.8563295962277164`*^9, 
   3.856329667366782*^9, 3.8563297633371224`*^9, 3.856336319879692*^9, 
   3.8563364182077117`*^9, 3.8563365004808846`*^9, 3.8563373031834126`*^9, 
   3.856344707043914*^9, 3.85634489980573*^9, 3.856345579727485*^9, 
   3.8563468765415273`*^9, 3.8563477951012588`*^9, 3.8563479474826374`*^9, 
   3.8563490071786356`*^9, 3.8563492612464447`*^9, 3.856349314045586*^9, 
   3.8563495390523205`*^9, 3.856349612408205*^9, 3.8563498849628415`*^9, 
   3.856349979546335*^9, 3.856350362546805*^9, 3.8563507094516726`*^9, 
   3.856350859232895*^9, 3.8564087199206057`*^9, 3.856408779575195*^9, 
   3.856408931051857*^9, 3.8564100654615836`*^9, 3.8564103162164345`*^9, 
   3.8564134729049144`*^9, 3.8564389790045595`*^9, 3.856439098726096*^9, 
   3.856439301876093*^9, {3.85651601130305*^9, 3.8565160320819674`*^9}, 
   3.856516173884809*^9, 3.85651630139989*^9, 3.856516357260439*^9, 
   3.85651665154832*^9, {3.856517175482836*^9, 3.856517193762339*^9}, 
   3.856517344272629*^9, 3.856517423862959*^9, 3.856517604492025*^9, 
   3.856517932554237*^9, 3.8565181524380302`*^9, 3.85653811928071*^9, 
   3.856539119049899*^9, 3.856539473338418*^9, 3.856539601671726*^9, 
   3.856540164579239*^9, 3.856541355132337*^9, 3.856542641461501*^9, 
   3.856542974434266*^9, 3.856543745030725*^9, 3.856544235803252*^9, 
   3.8565801008574467`*^9, 3.8565833263394833`*^9, 3.856586882115193*^9, 
   3.8630607821676893`*^9, 3.8630610225115023`*^9, 3.863061097836438*^9, 
   3.863061264881323*^9, 3.8630627293159823`*^9, 3.8630628248969383`*^9, 
   3.8630629605002837`*^9, 3.863063094104619*^9, 3.863063407037726*^9, 
   3.863063910067254*^9, 3.863064266917858*^9, 3.8630703344428687`*^9, 
   3.863070751347033*^9, 3.8630710067315283`*^9, 3.863071403433363*^9, 
   3.86307148717635*^9, 3.86307157663876*^9, 3.863072387913156*^9, 
   3.863072648561532*^9, 3.863072678690263*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"f613fbbd-c59a-43e7-9806-d4e443228a68"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "r22"}], " ", "+", " ", 
       RowBox[{"1", "/", "r02"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "r02"}], ")"}], "^", "2"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "r01"}], "+", 
           RowBox[{"1", "/", "r02"}], "+", 
           RowBox[{"1", "/", "r11"}], "+", 
           RowBox[{"1", "/", "r12"}]}], ")"}]}], ")"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}]}], "/.", "subst"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8563234492932796`*^9, 3.8563234597077265`*^9}, 
   3.8563246019802523`*^9, 3.8563251634446735`*^9, {3.856517206353546*^9, 
   3.856517210255118*^9}, {3.856517347679462*^9, 3.85651734906247*^9}, {
   3.856517936483953*^9, 3.856517938936138*^9}, {3.856518036905182*^9, 
   3.85651806075673*^9}, {3.856539605857563*^9, 3.856539606896718*^9}, {
   3.863060713915453*^9, 3.8630608079478664`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"e5e0189d-db0d-41d1-9683-cd35d06e8c21"],

Cell[BoxData[
 FractionBox[
  RowBox[{"r22", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r1", "2"], "+", 
     RowBox[{"4", " ", "r12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r12", "+", "r22"}], ")"}]}], "+", 
     RowBox[{"r1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"4", " ", "r12"}], "+", "r22"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["r1", "2"], "+", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
   RowBox[{"r1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"4", " ", "r12"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.856518061201654*^9, 3.856518154507758*^9, 3.856538119421649*^9, 
   3.856539121199205*^9, 3.856539476837356*^9, 3.856539607439012*^9, 
   3.856540166605666*^9, 3.856541361323835*^9, 3.856542451303644*^9, 
   3.856542983673435*^9, 3.8565437467168922`*^9, 3.856544237913397*^9, 
   3.856580102252638*^9, 3.856583327616794*^9, 3.856586882156364*^9, {
   3.8630607860578766`*^9, 3.8630608130055585`*^9}, 3.8630610226960077`*^9, 
   3.863061098091758*^9, 3.8630612650279303`*^9, 3.8630628282958517`*^9, 
   3.863062960639912*^9, 3.8630630942731676`*^9, 3.863063412002169*^9, 
   3.8630639102377977`*^9, 3.8630642669856815`*^9, 3.8630703345116835`*^9, 
   3.8630707614435368`*^9, 3.863071016183611*^9, 3.863071404862979*^9, 
   3.8630714882451878`*^9, 3.863071577785617*^9, 3.86307238907309*^9, 
   3.863072679570434*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"d710fb05-1541-45fa-8c24-4f6c546f450a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"constr", "=", 
   RowBox[{"term1", "-", "term2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.856541753258127*^9, 3.856541760063064*^9}, {
   3.856541882133155*^9, 3.8565418967640867`*^9}, 3.856543265494512*^9, {
   3.856543932879655*^9, 3.8565439558721313`*^9}, {3.856544131850336*^9, 
   3.8565441510948153`*^9}, {3.8565442580191793`*^9, 3.856544280695241*^9}, {
   3.856544332066082*^9, 3.856544335392528*^9}, {3.856580110988866*^9, 
   3.85658011246216*^9}, {3.856580146638941*^9, 3.856580181796113*^9}, {
   3.856580212214011*^9, 3.85658023093456*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"3bc3277f-9283-4727-94aa-d433dcc32690"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"e1", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"term1", ",", "r12"}], "]"}], "==", 
      RowBox[{"l", " ", 
       RowBox[{"D", "[", 
        RowBox[{"constr", ",", "r12"}], "]"}]}]}], ",", "l"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"e2", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"term1", ",", "r22"}], "]"}], "==", 
     RowBox[{"l", " ", 
      RowBox[{"D", "[", 
       RowBox[{"constr", ",", "r22"}], "]"}]}]}], ",", "l"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.856580186759542*^9, 3.856580205790196*^9}, {
  3.856580238404224*^9, 3.856580306331461*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"97408669-387f-4485-9142-5cd25f1353bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"l", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       FractionBox[
        RowBox[{"2", " ", "r12"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r1", "+", "r22"}]]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       FractionBox[
        RowBox[{"2", " ", "r12"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r1", "+", "r22"}]], "+", 
       FractionBox[
        RowBox[{"r22", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "r1"}], "+", 
           RowBox[{"4", " ", "r12"}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r12", "+", "r22"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox["r1", "2"], "+", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
         RowBox[{"r1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"4", " ", "r12"}]}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "r1"}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r12"}], ")"}]}], "+", 
           RowBox[{"4", " ", "r12"}]}], ")"}], " ", "r22", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r1", "2"], "+", 
           RowBox[{"4", " ", "r12", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r12", "+", "r22"}], ")"}]}], "+", 
           RowBox[{"r1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"4", " ", "r12"}], "+", "r22"}], ")"}]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r1", "2"], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
           RowBox[{"r1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"4", " ", "r12"}]}], ")"}]}]}], ")"}], "2"]]}], 
      ")"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.856543956227283*^9, {3.856544146606287*^9, 3.856544151707443*^9}, {
   3.8565442415029173`*^9, 3.856544259822599*^9}, 3.856544335994833*^9, {
   3.856580172921677*^9, 3.8565802012541943`*^9}, {3.856580266419265*^9, 
   3.856580306865817*^9}, 3.856583328180966*^9, 3.856586882191147*^9, 
   3.863061105388372*^9, 3.8630612650877714`*^9, 3.8630628367796826`*^9, 
   3.863062961296157*^9, 3.86306309438439*^9, 3.8630634133371334`*^9, 
   3.8630639104098625`*^9, 3.863064267039728*^9, 3.8630703345605545`*^9, 
   3.863070796854451*^9, 3.86307128174294*^9, 3.863071410341074*^9, 
   3.863071582367106*^9, {3.863072474927486*^9, 3.863072503152079*^9}, 
   3.863072681672839*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"d60684df-7ef1-4ba4-a72e-ab3575fc7f45"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"l", "\[Rule]", 
    FractionBox[
     SuperscriptBox["r12", "2"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1", "+", 
            RowBox[{"4", " ", "r12"}]}], ")"}], " ", "r22"}], 
         RowBox[{
          SuperscriptBox["r1", "2"], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
          RowBox[{"r1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", "r12"}]}], ")"}]}]}]], "+", 
        FractionBox[
         SuperscriptBox["r12", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], "2"]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["r1", "2"], "+", 
          RowBox[{"4", " ", "r12", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r12", "+", "r22"}], ")"}]}], "+", 
          RowBox[{"r1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", "r12"}], "+", "r22"}], ")"}]}]}], 
         RowBox[{
          SuperscriptBox["r1", "2"], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
          RowBox[{"r1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", "r12"}]}], ")"}]}]}]]}], ")"}]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.856543956227283*^9, {3.856544146606287*^9, 3.856544151707443*^9}, {
   3.8565442415029173`*^9, 3.856544259822599*^9}, 3.856544335994833*^9, {
   3.856580172921677*^9, 3.8565802012541943`*^9}, {3.856580266419265*^9, 
   3.856580306865817*^9}, 3.856583328180966*^9, 3.856586882191147*^9, 
   3.863061105388372*^9, 3.8630612650877714`*^9, 3.8630628367796826`*^9, 
   3.863062961296157*^9, 3.86306309438439*^9, 3.8630634133371334`*^9, 
   3.8630639104098625`*^9, 3.863064267039728*^9, 3.8630703345605545`*^9, 
   3.863070796854451*^9, 3.86307128174294*^9, 3.863071410341074*^9, 
   3.863071582367106*^9, {3.863072474927486*^9, 3.863072503152079*^9}, 
   3.8630726816747103`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"017a3920-0025-4062-9657-1d8e3abb3f10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e3", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"e1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "==", 
    RowBox[{
     RowBox[{
      RowBox[{"e2", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.85658034126271*^9, 3.856580367642894*^9}, {
  3.856582582862162*^9, 3.856582621572709*^9}, {3.8630729704571457`*^9, 
  3.863072979074954*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"7d6980d6-0d6d-4e52-84a5-aa62fddc57af"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"2", " ", "r12"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r1", "+", "r22"}]]}], 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"8", " ", "r12", " ", 
      RowBox[{"(", 
       RowBox[{"r1", "+", 
        RowBox[{"2", " ", "r12"}]}], ")"}], " ", 
      SuperscriptBox["r22", "2"]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r1", "2"], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
        RowBox[{"r1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"4", " ", "r12"}]}], ")"}]}]}], ")"}], "2"]], "+", 
    FractionBox[
     RowBox[{"2", " ", "r12"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r1", "+", "r22"}]]}]], "\[Equal]", 
  FractionBox[
   SuperscriptBox["r12", "2"], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", 
          RowBox[{"4", " ", "r12"}]}], ")"}], " ", "r22"}], 
       RowBox[{
        SuperscriptBox["r1", "2"], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
        RowBox[{"r1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"4", " ", "r12"}]}], ")"}]}]}]], "+", 
      FractionBox[
       SuperscriptBox["r12", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], "2"]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r1", "2"], "+", 
        RowBox[{"4", " ", "r12", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r12", "+", "r22"}], ")"}]}], "+", 
        RowBox[{"r1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"4", " ", "r12"}], "+", "r22"}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox["r1", "2"], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
        RowBox[{"r1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"4", " ", "r12"}]}], ")"}]}]}]]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.856580353066423*^9, 3.8565803682106037`*^9}, {
   3.856582586010902*^9, 3.856582603336256*^9}, 3.856583328692677*^9, 
   3.8565868821996717`*^9, 3.8630611210444984`*^9, 3.8630612651456175`*^9, 
   3.8630628396121902`*^9, 3.8630629641415524`*^9, 3.863063094513052*^9, 
   3.8630634146207004`*^9, 3.8630639130488076`*^9, 3.863064267100566*^9, 
   3.863070334630371*^9, 3.863070810206707*^9, 3.8630712835342197`*^9, 
   3.863071412558557*^9, 3.863071585222437*^9, 3.86307253165035*^9, 
   3.863072683215129*^9, 3.863072983578567*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"e5303d31-f43c-4c4a-967e-bd45ef081d61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"e3", ",", 
      RowBox[{"{", "r22", "}"}]}], "]"}], "[", 
    RowBox[{"[", "4", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8630634305821447`*^9, 3.8630634331496267`*^9}, {
  3.8630638318708105`*^9, 3.863063832624733*^9}, {3.8630733665463743`*^9, 
  3.863073588648477*^9}},
 NumberMarks->False,
 CellLabel->
  "In[147]:=",ExpressionUUID->"6aa51f3f-76eb-4b11-9427-99fd128aee1d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"r22", "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r1"}], ")"}], "2"], " ", "r1"}], "-", 
      RowBox[{"12", " ", "r12"}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"7", "-", 
         RowBox[{"4", " ", "r1"}]}], ")"}], " ", "r1", " ", "r12"}], "-", 
      RowBox[{"24", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r1"}], ")"}], " ", 
       SuperscriptBox["r12", "2"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["r12", "3"]}], "+", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r1"}], ")"}], "4"], " ", 
          SuperscriptBox["r1", "2"]}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r1"}], ")"}], "3"], " ", "r1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "r1"}]}], ")"}], " ", "r12"}], "+", 
         RowBox[{"16", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"5", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "r1"}], ")"}], " ", "r1"}]}], ")"}], 
          " ", 
          SuperscriptBox["r12", "2"]}], "+", 
         RowBox[{"16", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", 
            RowBox[{"11", " ", "r1"}]}], ")"}], " ", 
          SuperscriptBox["r12", "3"]}], "+", 
         RowBox[{"64", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"3", " ", "r1"}]}], ")"}], " ", 
          SuperscriptBox["r12", "4"]}], "+", 
         RowBox[{"128", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r1"}], ")"}], " ", 
          SuperscriptBox["r12", "5"]}], "+", 
         RowBox[{"64", " ", 
          SuperscriptBox["r12", "6"]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r1", "2"], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r12"}], ")"}], " ", "r12"}], "+", 
        RowBox[{"r1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"4", " ", "r12"}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.863063122397566*^9, 3.8630634339444966`*^9, 3.863063833938946*^9, 
   3.863063919126559*^9, 3.863064272106185*^9, 3.863070335223784*^9, 
   3.863070841347386*^9, 3.8630712849555893`*^9, 3.863071588136074*^9, 
   3.8630725360646772`*^9, 3.863072685120284*^9, {3.863073368814042*^9, 
   3.8630734102352667`*^9}, 3.863073447093666*^9, {3.863073495757257*^9, 
   3.863073590179331*^9}, 3.863073634792304*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"d8c78188-0451-4951-840b-17c43a57241c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solr22", "=", 
  RowBox[{"NSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"term1", "-", "term2"}], "\[Equal]", "0"}], "/.", "sol0"}], "/.", 
     RowBox[{"{", 
      RowBox[{"r1", "\[Rule]", "0.1"}], "}"}]}], ",", "r12"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.863073172713994*^9, 3.863073230821451*^9}, {
  3.86307362697854*^9, 3.863073665351791*^9}, {3.8630737342729692`*^9, 
  3.863073735948085*^9}, {3.863073778193645*^9, 3.863073801919379*^9}, {
  3.8630738349173403`*^9, 3.8630738538853416`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"f8d050b5-5b82-42a0-a4b7-1e5a3fbb8856"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r12", "\[Rule]", "1.5624210197526174`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r12", "\[Rule]", "0.23619435969811697`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.863073187520471*^9, 3.863073231358961*^9}, {
  3.863073629169963*^9, 3.86307363720474*^9}, {3.863073674700202*^9, 
  3.863073677353972*^9}, {3.863073772281848*^9, 3.86307380271*^9}, {
  3.8630738357488823`*^9, 3.863073881636471*^9}},
 CellLabel->
  "Out[158]=",ExpressionUUID->"2ac462bd-e41e-45b3-bc63-4d3962aef199"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol22", "/.", 
  RowBox[{"{", "r1", "}"}]}]], "Input",
 CellChangeTimes->{{3.863062124343647*^9, 3.8630621288715024`*^9}, {
  3.863073685524629*^9, 
  3.8630736967967577`*^9}},ExpressionUUID->"17054b3c-315d-4db0-ac1e-\
08b42d721e55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"r12", "\[Rule]", "0.6035533905932737`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.863062129494835*^9, 3.863062864789381*^9, 3.8630634692749133`*^9, 
   3.8630642737059216`*^9, 3.863070340500948*^9, {3.863070859188698*^9, 
   3.863070872068179*^9}, 3.863071348440752*^9, 3.863071603412066*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"29641dda-8c85-4354-a9fb-5561fc47aa38"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solr22", "/.", "ex"}]], "Input",
 CellChangeTimes->{{3.8630621919563646`*^9, 3.863062201621251*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"9029e6e4-03ac-4d24-ad16-88f1114b62c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"r22", "\[Rule]", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.863062202182745*^9, 3.8630628666685715`*^9, 
  3.863063470631305*^9, 3.8630642737148933`*^9, 3.8630703405079308`*^9, 
  3.8630708763325033`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"d46f9055-cca7-4150-80d4-87393bd4710c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r1"}], ")"}], "-", "r12", "-", "r22"}], "/.", 
    "sol"}], "/.", "solr22"}], "/.", "ex"}]], "Input",
 CellChangeTimes->{{3.863063476223567*^9, 3.863063547482723*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"d1d22844-9968-4588-b433-10fd95d72fd6"],

Cell[BoxData[
 RowBox[{"-", "0.04721359549995785`"}]], "Output",
 CellChangeTimes->{{3.8630634772787466`*^9, 3.8630635477809243`*^9}, 
   3.8630642737747364`*^9, 3.8630703405577965`*^9, 3.863070888358243*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"e6b0b131-8336-4bd4-b9c1-4b7c26ef5be0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "sol", "]"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"6d43223d-d135-4eeb-a65f-a6ab713645b2"],

Cell["List(Rule(r12,(1 + Sqrt(1 - r1) - r1)/2.))", "Output",
 CellChangeTimes->{3.863064273833579*^9, 3.8630703406091733`*^9},
 CellLabel->
  "Out[15]//CForm=",ExpressionUUID->"a8f36cb3-22a0-4668-abb4-cf8023b42e94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "solr22", "]"}]], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"140e6b88-7e38-41ac-8482-eaa88999e3d3"],

Cell["\<\
List(Rule(r22,(2*(1 + Sqrt(1 - r1) - r1) - Power(1 + Sqrt(1 - r1) - r1,2) + \
r1 - 2*(1 + Sqrt(1 - r1) - r1)*r1 - Power(r1,2))/
     (2*(1 + Sqrt(1 - r1) - r1) + r1)))\
\>", "Output",
 CellChangeTimes->{3.8630642738415575`*^9, 3.863070340653056*^9},
 CellLabel->
  "Out[16]//CForm=",ExpressionUUID->"7e6f41c1-64d2-45fe-a6ff-5c7b917f05f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"e3", ",", 
     RowBox[{"{", "r22", "}"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8630636354575334`*^9, 3.863063638718387*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"497b7dc4-afb1-4ee6-86d7-08cd2cb7311a"],

Cell["\<\
List(Rule(r22,(r1 - Power(r1,2) + 4*r12 - 4*r1*r12 - 4*Power(r12,2))/(r1 + \
4*r12)))\
\>", "Output",
 CellChangeTimes->{3.863063639354474*^9, 3.863064274128787*^9, 
  3.863070340933305*^9},
 CellLabel->
  "Out[17]//CForm=",ExpressionUUID->"c3a67f9e-995c-46ce-8457-e0e6f7f9fd6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"term1", "\[Equal]", "term2"}], ",", "r12"}], "]"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.863071656390943*^9, 3.863071696001803*^9}, {
  3.8630720923644257`*^9, 3.8630720978879957`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"7a72cee3-a9c3-4baa-b699-4b30d291a8ad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"r12", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "r1", "-", 
      SqrtBox[
       RowBox[{"1", "-", "r1", "-", 
        RowBox[{"4", " ", "r22"}], "+", 
        RowBox[{"4", " ", "r1", " ", "r22"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["r22", "2"]}]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8630716676579533`*^9, 3.863071696602909*^9}, 
   3.8630720993632603`*^9, 3.8630739470070543`*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"3da36cd1-42d3-42eb-8b76-637eb0581280"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term3", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"term1", "/.", "sol"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8630721182060003`*^9, 3.863072144823585*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"59449f22-a6c2-4737-9ca9-c714a58ad64a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"r22", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     RowBox[{"3", " ", "r1"}], "+", 
     RowBox[{"4", " ", "r22"}], "-", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "r22"}]}], ")"}], "2"], "+", 
        RowBox[{"r1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"4", " ", "r22"}]}], ")"}]}]}]]}]}], ")"}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.863072132743951*^9, 3.8630721455151777`*^9}},
 CellLabel->"Out[80]=",ExpressionUUID->"5a97aa8f-3f01-4c38-a98e-f6972d8e814b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"term3", ",", "r22"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.863072154419651*^9, 3.863072176390712*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"6f682417-6d32-49d0-bdf6-d1ea578aa99f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"r22", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"4", "-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r1", "+", 
           RowBox[{"2", " ", "r22"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "r22"}]}], ")"}], "2"], "+", 
          RowBox[{"r1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", "r22"}]}], ")"}]}]}]]]}], ")"}]}], "-", 
    RowBox[{"r22", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"3", " ", "r1"}], "+", 
       RowBox[{"4", " ", "r22"}], "-", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "r22"}]}], ")"}], "2"], "+", 
          RowBox[{"r1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", "r22"}]}], ")"}]}]}]]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"3", " ", "r1"}], "+", 
       RowBox[{"4", " ", "r22"}], "-", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "r22"}]}], ")"}], "2"], "+", 
          RowBox[{"r1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", "r22"}]}], ")"}]}]}]]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.863072165260751*^9, 3.863072178544297*^9}},
 CellLabel->"Out[82]=",ExpressionUUID->"92ee0fc9-d7a3-4f71-814d-1c3369503a74"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol2", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"r22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "-", 
          FractionBox[
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r1", "+", 
              RowBox[{"2", " ", "r22"}]}], ")"}]}], 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "r22"}]}], ")"}], "2"], "+", 
             RowBox[{"r1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "r22"}]}], ")"}]}]}]]]}], ")"}]}], "-", 
       RowBox[{"r22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"3", " ", "r1"}], "+", 
          RowBox[{"4", " ", "r22"}], "-", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "r22"}]}], ")"}], "2"], "+", 
             RowBox[{"r1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "r22"}]}], ")"}]}]}]]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r1", "+", "r22"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"3", " ", "r1"}], "+", 
          RowBox[{"4", " ", "r22"}], "-", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "r22"}]}], ")"}], "2"], "+", 
             RowBox[{"r1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "r22"}]}], ")"}]}]}]]}]}], ")"}]}]}], 
      "\[Equal]", "0"}], ",", "r22"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8630716976453333`*^9, 3.863071730393339*^9}, {
  3.863071831250725*^9, 3.8630718332977257`*^9}, {3.863071893756654*^9, 
  3.863071898840904*^9}, {3.8630719881555643`*^9, 3.863072044067643*^9}, {
  3.863072078977304*^9, 3.86307208120477*^9}, {3.863072114549398*^9, 
  3.86307211678834*^9}, {3.8630721985097647`*^9, 3.86307224284509*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"1de7a9a6-8ff2-4cdb-a0fd-58f8c1413fc5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol2", "/.", 
  RowBox[{"{", 
   RowBox[{"r1", "->", "0.1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8630722502702627`*^9, 3.8630722875984497`*^9}, {
  3.8630723180752563`*^9, 3.863072336884362*^9}, {3.863073893868884*^9, 
  3.863073898188274*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"5f3513b9-b83f-46ea-8fbd-d493a1da7d82"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r22", "\[Rule]", 
     RowBox[{"0.8750480470978207`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.11073631223722451`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r22", "\[Rule]", 
     RowBox[{"0.8750480470978207`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.11073631223722451`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r22", "\[Rule]", "0.2976423555416454`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r22", "\[Rule]", "1.5522615502627133`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.863072271890141*^9, 3.863072289237236*^9}, {
   3.863072321857271*^9, 3.863072338901413*^9}, 3.863073899270893*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"3a546cca-b7c6-40f9-91a3-baece16be947"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", "/.", "sol2"}], "/.", 
  RowBox[{"{", 
   RowBox[{"r1", "->", "0.1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.863071745063478*^9, 3.863071748967132*^9}, {
  3.8630739516726313`*^9, 3.8630739889103203`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"567f1adf-ab14-402b-84ad-78bb0bed5615"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r12", "\[Rule]", 
     RowBox[{"0.0006923102746106968`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.10475728400734531`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r12", "\[Rule]", 
     RowBox[{"0.0006923102746106968`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.10475728400734531`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r12", "\[Rule]", "0.2361943596981165`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r12", "\[Rule]", 
     RowBox[{"-", "0.6624210197526654`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8630717462261868`*^9, 3.863071749481436*^9}, 
   3.863073989710272*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"8cc53152-ea20-4889-9cf8-dc839e9ed09d"]
}, Open  ]]
},
WindowSize->{718.5, 771.},
WindowMargins->{{Automatic, -4.2000000000000455`}, {607.8, Automatic}},
TaggingRules-><|"SlideshowSettings" -> <|"Toolbar" -> True|>|>,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f3fc079a-8de7-4509-8fc0-cd38a07d762b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 926, 16, 264, "Text",ExpressionUUID->"f7ba8136-f710-4688-b231-5d7e388e68b5"],
Cell[1487, 38, 301, 7, 35, "Text",ExpressionUUID->"7e7f6402-700e-4c0c-a04d-6f80a5a1effe"],
Cell[CellGroupData[{
Cell[1813, 49, 1177, 18, 29, "Input",ExpressionUUID->"a2d3e9a1-2d98-42bd-bb2c-c44d17fc2dab"],
Cell[2993, 69, 1972, 33, 48, "Output",ExpressionUUID->"7a9f604e-277a-437c-85cd-bfefd7689931"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5002, 107, 509, 10, 28, "Input",ExpressionUUID->"df82f182-6836-4609-9fbb-300ae0505d73"],
Cell[5514, 119, 302, 6, 32, "Output",ExpressionUUID->"e9fc5f0c-4c36-472f-80a8-f2e74008b3d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5853, 130, 391, 10, 28, "Input",ExpressionUUID->"1b44415d-5a73-4b50-8680-1efc9d312751"],
Cell[6247, 142, 431, 10, 48, "Output",ExpressionUUID->"64bf9970-7e04-4e01-b1ac-78557d67a4c3"]
}, Open  ]],
Cell[6693, 155, 733, 16, 158, "Text",ExpressionUUID->"54ff16e6-289c-48e2-962e-d9bff39fa4b2"],
Cell[CellGroupData[{
Cell[7451, 175, 890, 22, 28, "Input",ExpressionUUID->"c76aa63c-8ff6-4e2d-a363-ca301193fbd0"],
Cell[8344, 199, 2218, 36, 50, "Output",ExpressionUUID->"f613fbbd-c59a-43e7-9806-d4e443228a68"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10599, 240, 1193, 29, 67, "Input",ExpressionUUID->"e5e0189d-db0d-41d1-9683-cd35d06e8c21"],
Cell[11795, 271, 1660, 40, 55, "Output",ExpressionUUID->"d710fb05-1541-45fa-8c24-4f6c546f450a"]
}, Open  ]],
Cell[13470, 314, 673, 12, 28, "Input",ExpressionUUID->"3bc3277f-9283-4727-94aa-d433dcc32690"],
Cell[CellGroupData[{
Cell[14168, 330, 812, 25, 48, "Input",ExpressionUUID->"97408669-387f-4485-9142-5cd25f1353bd"],
Cell[14983, 357, 3267, 89, 107, "Output",ExpressionUUID->"d60684df-7ef1-4ba4-a72e-ab3575fc7f45"],
Cell[18253, 448, 2680, 71, 127, "Output",ExpressionUUID->"017a3920-0025-4062-9657-1d8e3abb3f10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20970, 524, 712, 20, 28, "Input",ExpressionUUID->"7d6980d6-0d6d-4e52-84a5-aa62fddc57af"],
Cell[21685, 546, 3274, 95, 135, "Output",ExpressionUUID->"e5303d31-f43c-4c4a-967e-bd45ef081d61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24996, 646, 511, 13, 28, "Input",ExpressionUUID->"6aa51f3f-76eb-4b11-9427-99fd128aee1d"],
Cell[25510, 661, 3639, 104, 119, "Output",ExpressionUUID->"d8c78188-0451-4951-840b-17c43a57241c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29186, 770, 652, 16, 28, "Input",ExpressionUUID->"f8d050b5-5b82-42a0-a4b7-1e5a3fbb8856"],
Cell[29841, 788, 566, 13, 32, "Output",ExpressionUUID->"2ac462bd-e41e-45b3-bc63-4d3962aef199"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30444, 806, 257, 6, 28, "Input",ExpressionUUID->"17054b3c-315d-4db0-ac1e-08b42d721e55"],
Cell[30704, 814, 413, 7, 32, "Output",ExpressionUUID->"29641dda-8c85-4354-a9fb-5561fc47aa38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31154, 826, 203, 3, 28, "Input",ExpressionUUID->"9029e6e4-03ac-4d24-ad16-88f1114b62c0"],
Cell[31360, 831, 328, 6, 32, "Output",ExpressionUUID->"d46f9055-cca7-4150-80d4-87393bd4710c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31725, 842, 350, 9, 28, "Input",ExpressionUUID->"d1d22844-9968-4588-b433-10fd95d72fd6"],
Cell[32078, 853, 287, 4, 32, "Output",ExpressionUUID->"e6b0b131-8336-4bd4-b9c1-4b7c26ef5be0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32402, 862, 139, 2, 28, "Input",ExpressionUUID->"6d43223d-d135-4eeb-a65f-a6ab713645b2"],
Cell[32544, 866, 215, 3, 45, "Output",ExpressionUUID->"a8f36cb3-22a0-4668-abb4-cf8023b42e94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32796, 874, 142, 2, 28, "Input",ExpressionUUID->"140e6b88-7e38-41ac-8482-eaa88999e3d3"],
Cell[32941, 878, 348, 7, 62, "Output",ExpressionUUID->"7e6f41c1-64d2-45fe-a6ff-5c7b917f05f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33326, 890, 344, 8, 28, "Input",ExpressionUUID->"497b7dc4-afb1-4ee6-86d7-08cd2cb7311a"],
Cell[33673, 900, 289, 7, 45, "Output",ExpressionUUID->"c3a67f9e-995c-46ce-8457-e0e6f7f9fd6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33999, 912, 406, 10, 28, "Input",ExpressionUUID->"7a72cee3-a9c3-4baa-b699-4b30d291a8ad"],
Cell[34408, 924, 603, 16, 48, "Output",ExpressionUUID->"3da36cd1-42d3-42eb-8b76-637eb0581280"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35048, 945, 266, 5, 28, "Input",ExpressionUUID->"59449f22-a6c2-4737-9ca9-c714a58ad64a"],
Cell[35317, 952, 818, 25, 60, "Output",ExpressionUUID->"5a97aa8f-3f01-4c38-a98e-f6972d8e814b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36172, 982, 268, 5, 28, "Input",ExpressionUUID->"6f682417-6d32-49d0-bdf6-d1ea578aa99f"],
Cell[36443, 989, 2314, 74, 135, "Output",ExpressionUUID->"92ee0fc9-d7a3-4f71-814d-1c3369503a74"]
}, Open  ]],
Cell[38772, 1066, 2734, 75, 142, "Input",ExpressionUUID->"1de7a9a6-8ff2-4cdb-a0fd-58f8c1413fc5"],
Cell[CellGroupData[{
Cell[41531, 1145, 357, 8, 28, "Input",ExpressionUUID->"5f3513b9-b83f-46ea-8fbd-d493a1da7d82"],
Cell[41891, 1155, 825, 19, 52, "Output",ExpressionUUID->"3a546cca-b7c6-40f9-91a3-baece16be947"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42753, 1179, 332, 8, 28, "Input",ExpressionUUID->"567f1adf-ab14-402b-84ad-78bb0bed5615"],
Cell[43088, 1189, 805, 19, 52, "Output",ExpressionUUID->"8cc53152-ea20-4889-9cf8-dc839e9ed09d"]
}, Open  ]]
}
]
*)

