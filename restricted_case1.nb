(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23023,        651]
NotebookOptionsPosition[     18568,        567]
NotebookOutlinePosition[     18972,        583]
CellTagsIndexPosition[     18929,        580]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.856319279666086*^9, {3.856324804112049*^9, 
   3.8563248104251356`*^9}},ExpressionUUID->"17879fcb-a269-4b38-8c8b-\
0b8283cd78bf"],

Cell[TextData[{
 StyleBox["Computations on restricted case 1", "Title"],
 "\n",
 StyleBox["Set (and simplify) conditions", "Section"]
}], "Text",
 CellChangeTimes->{{3.8563248189079075`*^9, 3.8563248504343576`*^9}, 
   3.8563248902348986`*^9},ExpressionUUID->"f7ba8136-f710-4688-b231-\
5d7e388e68b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r11", "=", " ", 
  RowBox[{
   RowBox[{"N1", "/", "N"}], " ", "-", " ", "r01"}]}]], "Input",
 CellChangeTimes->{{3.856241055409762*^9, 3.8562410574112105`*^9}, {
  3.8562410945331097`*^9, 3.8562411481989813`*^9}, {3.8562413942892437`*^9, 
  3.8562413985865993`*^9}, {3.8563191337338676`*^9, 3.85631916052186*^9}, {
  3.8563191921179976`*^9, 3.8563192853897457`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a2d3e9a1-2d98-42bd-bb2c-c44d17fc2dab"],

Cell[BoxData[
 RowBox[{
  FractionBox["N1", "N"], "-", "r01"}]], "Output",
 CellChangeTimes->{{3.856319282238423*^9, 3.8563193164167747`*^9}, 
   3.856319394500353*^9, 3.85632780753021*^9, 3.856328261976218*^9, 
   3.8563295826649675`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"90333648-cf92-403c-b166-ec70a5ed1255"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cond1", " ", "=", " ", 
  RowBox[{
  "r01", "+", "r11", "+", "r02", "+", "r12", "+", "r22", "+", "r03", "+", 
   "r23"}]}]], "Input",
 CellChangeTimes->{{3.8563193231038356`*^9, 3.856319369821841*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"99d893af-5a00-4c24-af45-f1500079b174"],

Cell[BoxData[
 RowBox[{
  FractionBox["N1", "N"], "+", "r02", "+", "r03", "+", "r12", "+", "r22", "+",
   "r23"}]], "Output",
 CellChangeTimes->{{3.856319324104393*^9, 3.856319396685215*^9}, 
   3.85632780794596*^9, 3.856328262601755*^9, 3.8563295850453415`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"ee2d25e3-e051-4e52-ba82-c10b9cff6625"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "r01", "+", "r11", "+", "r02", "+", "r12", "+", "r22", "+", "r03", "+", 
     "r23"}], "==", "1"}], ",", " ", "r23"}], "]"}]], "Input",
 CellChangeTimes->{{3.8563193606853905`*^9, 3.856319448507247*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"fb517641-b73a-4402-b1c2-164642798fd9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r23", "\[Rule]", 
    FractionBox[
     RowBox[{"N", "-", "N1", "-", 
      RowBox[{"N", " ", "r02"}], "-", 
      RowBox[{"N", " ", "r03"}], "-", 
      RowBox[{"N", " ", "r12"}], "-", 
      RowBox[{"N", " ", "r22"}]}], "N"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8563193904111233`*^9, 3.8563194234792233`*^9}, 
   3.856319461161495*^9, 3.856327809925342*^9, 3.856328263762572*^9, 
   3.856329586277425*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"f1f1005b-ea34-4f0c-b9cc-489543eef27b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r23", "=", 
  FractionBox[
   RowBox[{"N", "-", "N1", "-", 
    RowBox[{"N", " ", "r02"}], "-", 
    RowBox[{"N", " ", "r03"}], "-", 
    RowBox[{"N", " ", "r12"}], "-", 
    RowBox[{"N", " ", "r22"}]}], "N"]}]], "Input",
 NumberMarks->False,
 CellLabel->"In[5]:=",ExpressionUUID->"acd0e690-5aee-443b-aebd-0124e63efd84"],

Cell[BoxData[
 FractionBox[
  RowBox[{"N", "-", "N1", "-", 
   RowBox[{"N", " ", "r02"}], "-", 
   RowBox[{"N", " ", "r03"}], "-", 
   RowBox[{"N", " ", "r12"}], "-", 
   RowBox[{"N", " ", "r22"}]}], "N"]], "Output",
 CellChangeTimes->{3.8563195427337713`*^9, 3.856327813023919*^9, 
  3.856328264604437*^9, 3.856329587744345*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"480c526a-edfc-43cd-8a73-b648d92f3f6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "r23", "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[6]:=",ExpressionUUID->"ceb1af6b-0a89-4f16-bf0c-652b69c96038"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"N1", "+", 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r02", "+", "r03", "+", "r12", "+", "r22"}], 
      ")"}]}]}], "N"]}]], "Output",
 CellChangeTimes->{3.8563195479993415`*^9, 3.8563278154146185`*^9, 
  3.856328265558276*^9, 3.8563295892618437`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"f27f0cec-cb35-4640-963f-73c0ffc150d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"N1", "+", 
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r02", "+", "r03", "+", "r12", "+", "r22"}], 
       ")"}]}]}], "N"]}], "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[7]:=",ExpressionUUID->"d71a7078-393b-4c40-8ffa-d4d572fc0ca8"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox["N1", "N"], "-", "r02", "-", "r03", "-", "r12", "-", 
  "r22"}]], "Output",
 CellChangeTimes->{3.856319588638213*^9, 3.856327836560487*^9, 
  3.8563282668513775`*^9, 3.8563295909936175`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"04ef66fd-d648-46bb-b5fd-7ce1bbdf9a9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r22", "=", " ", 
  RowBox[{
   RowBox[{"N2", "/", "N"}], " ", "-", " ", "r02", "-", "r12"}]}]], "Input",
 CellChangeTimes->{{3.8563278396887913`*^9, 3.856327851778936*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"9724eb96-5b49-4d23-b82f-1d9f69eb6803"],

Cell[BoxData[
 RowBox[{
  FractionBox["N2", "N"], "-", "r02", "-", "r12"}]], "Output",
 CellChangeTimes->{3.85632785266232*^9, 3.8563282679646406`*^9, 
  3.8563295923989544`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"c959195d-d03a-45fb-bc11-c26f06f9fc80"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Define terms to optimise", "Section"],
 "\nNote: ",
 StyleBox["sigma*term1^(-1)/N",
  FontSlant->"Italic"],
 " is the variance of the estimator of effect 1 (analogously ",
 StyleBox["sigma*term2^(-1)/N",
  FontSlant->"Italic"],
 " for effect 2). But since sigma and N are fixed, we simply work on term1 \
and term2 expressions."
}], "Text",
 CellChangeTimes->{{3.856324859103889*^9, 3.8563248655216613`*^9}, {
   3.8563249258313665`*^9, 3.8563250321024923`*^9}, {3.856325108777877*^9, 
   3.856325130602702*^9}, 
   3.856330176662778*^9},ExpressionUUID->"54ff16e6-289c-48e2-962e-\
d9bff39fa4b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r11", "*", 
     RowBox[{"r01", "/", 
      RowBox[{"(", 
       RowBox[{"r11", "+", "r01"}], ")"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"r12", "*", 
     RowBox[{"r02", "/", 
      RowBox[{"(", 
       RowBox[{"r12", "+", "r02"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8563246032441535`*^9, 3.856324603752307*^9}, {
   3.856324922372285*^9, 3.856324923755909*^9}, 3.856325158114187*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"c76aa63c-8ff6-4e2d-a363-ca301193fbd0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["N1", "N"], "-", "r01"}], ")"}], " ", "r01"}], "N1"], "+", 
  FractionBox[
   RowBox[{"r02", " ", "r12"}], 
   RowBox[{"r02", "+", "r12"}]]}]], "Output",
 CellChangeTimes->{3.8563278613553805`*^9, 3.8563282707941904`*^9, 
  3.8563295962277164`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"d43fa55c-54db-4a86-ad9c-25da1f28a5bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term2", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r22", "*", 
     RowBox[{"r02", "/", 
      RowBox[{"(", 
       RowBox[{"r22", "+", "r02"}], ")"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"r23", "*", 
     RowBox[{"r03", "/", 
      RowBox[{"(", 
       RowBox[{"r23", "+", "r03"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8563234492932796`*^9, 3.8563234597077265`*^9}, 
   3.8563246019802523`*^9, 3.8563251634446735`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"e5e0189d-db0d-41d1-9683-cd35d06e8c21"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"r02", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["N2", "N"], "-", "r02", "-", "r12"}], ")"}]}], 
   RowBox[{
    FractionBox["N2", "N"], "-", "r12"}]], "+", 
  FractionBox[
   RowBox[{"r03", " ", 
    RowBox[{"(", 
     RowBox[{"N", "-", "N1", "-", 
      RowBox[{"N", " ", "r02"}], "-", 
      RowBox[{"N", " ", "r03"}], "-", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["N2", "N"], "-", "r02", "-", "r12"}], ")"}]}], "-", 
      RowBox[{"N", " ", "r12"}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{"r03", "+", 
      FractionBox[
       RowBox[{"N", "-", "N1", "-", 
        RowBox[{"N", " ", "r02"}], "-", 
        RowBox[{"N", " ", "r03"}], "-", 
        RowBox[{"N", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["N2", "N"], "-", "r02", "-", "r12"}], ")"}]}], "-", 
        RowBox[{"N", " ", "r12"}]}], "N"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.8563278761046624`*^9, 3.856328272509074*^9, 
  3.856329598437084*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"d3c71331-f453-4525-8bcc-837f0db7c70a"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Optimisation with respect to ", "Section"],
 StyleBox["r01", "Section",
  FontSlant->"Italic"],
 StyleBox[" and ", "Section"],
 StyleBox["r02", "Section",
  FontSlant->"Italic"],
 "\nDerivative with respect to ",
 StyleBox["r02",
  FontSlant->"Italic"],
 " for the variance term of effect 2"
}], "Text",
 CellChangeTimes->{{3.8563280844638596`*^9, 3.8563281047150044`*^9}, 
   3.856328449658295*^9, {3.856330147428607*^9, 
   3.8563301646889915`*^9}},ExpressionUUID->"ff9d29d7-d41e-46ae-be14-\
9bc98baf8da0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"term2", "^", 
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}]}], ",", "r02"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.8563234732593584`*^9, 3.8563245991304283`*^9, {3.8563279469649763`*^9, 
   3.8563279528325624`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"5e88a4f6-582e-4ef8-92a9-fcb4f84130bb"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "N"}], "+", "N1", "+", "N2"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "N2"}], "+", 
      RowBox[{"N", " ", "r12"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "N2"}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "r02"}], "+", "r12"}], ")"}]}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"N2", " ", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "N2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"r02", "+", "r03"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["N", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r02", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r02", "+", "r03", "-", 
            SuperscriptBox["r03", "2"]}], ")"}], " ", "r12"}]}], ")"}]}], "-", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N2", " ", 
          RowBox[{"(", 
           RowBox[{"r02", "+", "r03"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "r02", "-", "r03", "+", "r12"}], ")"}]}], "+", 
         RowBox[{"N1", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r02", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r02", "+", "r03"}], ")"}], " ", "r12"}]}], ")"}]}]}], 
        ")"}]}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.856327954704825*^9, 3.8563282347614436`*^9, 
  3.856328275473196*^9, 3.8563296035206404`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"9419de02-5799-4905-9211-b4f5131f7be1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"term2", "^", 
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}]}], ",", "r02"}], "]"}], "]"}], "==", 
     "0"}], ",", "r02"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8563279766633277`*^9, 3.856327984234539*^9}, {
  3.856328025975574*^9, 3.856328031529837*^9}, {3.856328152721424*^9, 
  3.856328166679206*^9}, {3.856328197602298*^9, 3.8563282219319043`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"94ef465d-f466-49a5-b225-629cdfb76c93"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r02", "\[Rule]", 
    FractionBox[
     RowBox[{"N2", "-", 
      RowBox[{"N", " ", "r12"}]}], 
     RowBox[{"2", " ", "N"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8563279848374586`*^9, 3.8563280321883516`*^9, 3.8563281677436705`*^9, {
   3.8563281982092524`*^9, 3.8563282223353405`*^9}, 3.856328278166045*^9, 
   3.8563296060195293`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"b8c8dfbf-562a-432e-9436-3488db81dedf"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.856328429254281*^9},ExpressionUUID->"4e56f3f2-b49f-4b51-9a78-\
0e46d32ce141"],

Cell["Using result obtained for var1:", "Text",
 CellChangeTimes->{{3.856328386713769*^9, 
  3.85632840106787*^9}},ExpressionUUID->"e3bbc12c-e936-4ade-a168-\
3a8977f0cb75"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"r02", "=", 
   FractionBox[
    RowBox[{"N2", "-", 
     RowBox[{"N", " ", "r12"}]}], 
    RowBox[{"2", " ", "N"}]]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.856328302052721*^9, 3.8563283081646175`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a84d5933-51c1-4627-b9a8-3207a373647b"],

Cell[BoxData[
 FractionBox[
  RowBox[{"N2", "-", 
   RowBox[{"N", " ", "r12"}]}], 
  RowBox[{"2", " ", "N"}]]], "Output",
 CellChangeTimes->{{3.8563283092641635`*^9, 3.8563283226826286`*^9}, 
   3.8563296093191867`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"f761d538-aa2b-499b-a6a6-c5a843265513"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["term1"], "Input",
 CellChangeTimes->{{3.856323482608943*^9, 3.856323494271673*^9}, 
   3.856324595128265*^9, {3.8563281400152984`*^9, 3.8563281880346675`*^9}, 
   3.8563282810866327`*^9, {3.856328316351859*^9, 3.856328317916691*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"f3d2444f-79d8-4d77-8e31-3e775c167e78"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["N1", "N"], "-", "r01"}], ")"}], " ", "r01"}], "N1"], "+", 
  FractionBox[
   RowBox[{"r12", " ", 
    RowBox[{"(", 
     RowBox[{"N2", "-", 
      RowBox[{"N", " ", "r12"}]}], ")"}]}], 
   RowBox[{"2", " ", "N", " ", 
    RowBox[{"(", 
     RowBox[{"r12", "+", 
      FractionBox[
       RowBox[{"N2", "-", 
        RowBox[{"N", " ", "r12"}]}], 
       RowBox[{"2", " ", "N"}]]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.856328176213377*^9, 3.8563281885309916`*^9}, {
   3.8563283191719027`*^9, 3.856328323496957*^9}, 3.856329611790247*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"5638398e-b4bc-4d0e-aabb-ccebbf8b35b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"term1", ",", "r01"}], "]"}], "==", "0"}], ",", "r01"}], " ", 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.856324592754855*^9, 3.8563245927578497`*^9}, {
  3.856328336590768*^9, 3.8563283552640824`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"224d69f5-696f-484a-9c92-10e89873f2a7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r01", "\[Rule]", 
    FractionBox["N1", 
     RowBox[{"2", " ", "N"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.856328355745511*^9, 3.8563296164438725`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"007dbd1b-a16e-4187-8617-ad6d648a7f1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r01", "=", 
  FractionBox["N1", 
   RowBox[{"2", " ", "N"}]]}]], "Input",
 CellChangeTimes->{{3.856323577359247*^9, 3.8563236161945024`*^9}, {
   3.8563238106072507`*^9, 3.85632381170189*^9}, {3.856323859493959*^9, 
   3.8563238640424747`*^9}, {3.856323931526189*^9, 3.856323946294726*^9}, 
   3.8563245876299477`*^9, {3.8563284920723248`*^9, 3.85632849371913*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"57118cae-0a01-41cb-a228-cd5ab23187f0"],

Cell[BoxData[
 FractionBox["N1", 
  RowBox[{"2", " ", "N"}]]], "Output",
 CellChangeTimes->{3.8563284948698883`*^9, 3.85632962016603*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"41ac682a-7e7f-4019-a817-3a770bcb73d7"]
}, Open  ]],

Cell["Then expr = 1-r03 as r01+r11+r02+r12+r22+r03+r23=1", "Text",
 CellChangeTimes->{{3.8563287285059505`*^9, 3.85632873434361*^9}, {
  3.85632880142154*^9, 3.856328801878651*^9}, {3.856329437585374*^9, 
  3.8563294630399737`*^9}},ExpressionUUID->"23136066-6d22-4771-a947-\
71b15dde385a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r01", "+", "r11", "+", "r02", "+", "r12", "+", "r22", "+", 
  "r23"}]], "Input",
 CellChangeTimes->{{3.856329505237963*^9, 3.8563295206986227`*^9}, 
   3.8563296307463837`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"da89fecd-7daf-4bec-a768-ad306df54aef"],

Cell[BoxData[
 RowBox[{
  FractionBox["N1", "N"], "+", 
  FractionBox["N2", "N"], "+", 
  FractionBox[
   RowBox[{"N", "-", "N1", "-", 
    RowBox[{"N", " ", "r03"}], "-", 
    RowBox[{"N", " ", "r12"}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "N2"}], "+", 
       RowBox[{"N", " ", "r12"}]}], ")"}]}], "-", 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["N2", "N"], "-", "r12", "-", 
       FractionBox[
        RowBox[{"N2", "-", 
         RowBox[{"N", " ", "r12"}]}], 
        RowBox[{"2", " ", "N"}]]}], ")"}]}]}], "N"]}]], "Output",
 CellChangeTimes->{{3.8563296253708067`*^9, 3.8563296325265503`*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"831b18ad-7999-4392-aa1b-8a07a2e1434b"]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"53da5d6f-dac8-49d9-8f7d-2ea1c29297a1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 199, 4, 48, "Input",ExpressionUUID->"17879fcb-a269-4b38-8c8b-0b8283cd78bf"],
Cell[760, 26, 300, 7, 111, "Text",ExpressionUUID->"f7ba8136-f710-4688-b231-5d7e388e68b5"],
Cell[CellGroupData[{
Cell[1085, 37, 468, 8, 28, "Input",ExpressionUUID->"a2d3e9a1-2d98-42bd-bb2c-c44d17fc2dab"],
Cell[1556, 47, 317, 6, 48, "Output",ExpressionUUID->"90333648-cf92-403c-b166-ec70a5ed1255"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1910, 58, 303, 6, 28, "Input",ExpressionUUID->"99d893af-5a00-4c24-af45-f1500079b174"],
Cell[2216, 66, 340, 6, 48, "Output",ExpressionUUID->"ee2d25e3-e051-4e52-ba82-c10b9cff6625"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2593, 77, 359, 8, 28, "Input",ExpressionUUID->"fb517641-b73a-4402-b1c2-164642798fd9"],
Cell[2955, 87, 555, 13, 48, "Output",ExpressionUUID->"f1f1005b-ea34-4f0c-b9cc-489543eef27b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3547, 105, 344, 9, 45, "Input",ExpressionUUID->"acd0e690-5aee-443b-aebd-0124e63efd84"],
Cell[3894, 116, 407, 9, 48, "Output",ExpressionUUID->"480c526a-edfc-43cd-8a73-b648d92f3f6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4338, 130, 162, 3, 28, "Input",ExpressionUUID->"ceb1af6b-0a89-4f16-bf0c-652b69c96038"],
Cell[4503, 135, 432, 11, 48, "Output",ExpressionUUID->"f27f0cec-cb35-4640-963f-73c0ffc150d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4972, 151, 375, 11, 45, "Input",ExpressionUUID->"d71a7078-393b-4c40-8ffa-d4d572fc0ca8"],
Cell[5350, 164, 316, 6, 48, "Output",ExpressionUUID->"04ef66fd-d648-46bb-b5fd-7ce1bbdf9a9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5703, 175, 274, 5, 28, "Input",ExpressionUUID->"9724eb96-5b49-4d23-b82f-1d9f69eb6803"],
Cell[5980, 182, 256, 5, 48, "Output",ExpressionUUID->"c959195d-d03a-45fb-bc11-c26f06f9fc80"]
}, Open  ]],
Cell[6251, 190, 622, 15, 97, "Text",ExpressionUUID->"54ff16e6-289c-48e2-962e-d9bff39fa4b2"],
Cell[CellGroupData[{
Cell[6898, 209, 570, 15, 28, "Input",ExpressionUUID->"c76aa63c-8ff6-4e2d-a363-ca301193fbd0"],
Cell[7471, 226, 437, 12, 55, "Output",ExpressionUUID->"d43fa55c-54db-4a86-ad9c-25da1f28a5bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7945, 243, 553, 15, 28, "Input",ExpressionUUID->"e5e0189d-db0d-41d1-9683-cd35d06e8c21"],
Cell[8501, 260, 1160, 34, 81, "Output",ExpressionUUID->"d3c71331-f453-4525-8bcc-837f0db7c70a"]
}, Open  ]],
Cell[9676, 297, 535, 15, 74, "Text",ExpressionUUID->"ff9d29d7-d41e-46ae-be14-9bc98baf8da0"],
Cell[CellGroupData[{
Cell[10236, 316, 400, 10, 28, "Input",ExpressionUUID->"5e88a4f6-582e-4ef8-92a9-fcb4f84130bb"],
Cell[10639, 328, 1766, 54, 57, "Output",ExpressionUUID->"9419de02-5799-4905-9211-b4f5131f7be1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12442, 387, 641, 15, 28, "Input",ExpressionUUID->"94ef465d-f466-49a5-b225-629cdfb76c93"],
Cell[13086, 404, 488, 12, 48, "Output",ExpressionUUID->"b8c8dfbf-562a-432e-9436-3488db81dedf"]
}, Open  ]],
Cell[13589, 419, 147, 3, 48, "Input",ExpressionUUID->"4e56f3f2-b49f-4b51-9a78-0e46d32ce141"],
Cell[13739, 424, 172, 3, 35, "Text",ExpressionUUID->"e3bbc12c-e936-4ade-a168-3a8977f0cb75"],
Cell[CellGroupData[{
Cell[13936, 431, 335, 8, 66, "Input",ExpressionUUID->"a84d5933-51c1-4627-b9a8-3207a373647b"],
Cell[14274, 441, 298, 7, 48, "Output",ExpressionUUID->"f761d538-aa2b-499b-a6a6-c5a843265513"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14609, 453, 326, 4, 28, "Input",ExpressionUUID->"f3d2444f-79d8-4d77-8e31-3e775c167e78"],
Cell[14938, 459, 736, 21, 64, "Output",ExpressionUUID->"5638398e-b4bc-4d0e-aabb-ccebbf8b35b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15711, 485, 420, 10, 28, "Input",ExpressionUUID->"224d69f5-696f-484a-9c92-10e89873f2a7"],
Cell[16134, 497, 300, 7, 48, "Output",ExpressionUUID->"007dbd1b-a16e-4187-8617-ad6d648a7f1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16471, 509, 468, 8, 45, "Input",ExpressionUUID->"57118cae-0a01-41cb-a228-cd5ab23187f0"],
Cell[16942, 519, 216, 4, 48, "Output",ExpressionUUID->"41ac682a-7e7f-4019-a817-3a770bcb73d7"]
}, Open  ]],
Cell[17173, 526, 289, 4, 35, "Text",ExpressionUUID->"23136066-6d22-4771-a947-71b15dde385a"],
Cell[CellGroupData[{
Cell[17487, 534, 279, 5, 28, "Input",ExpressionUUID->"da89fecd-7daf-4bec-a768-ad306df54aef"],
Cell[17769, 541, 783, 23, 55, "Output",ExpressionUUID->"831b18ad-7999-4392-aa1b-8a07a2e1434b"]
}, Open  ]]
}
]
*)

