(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27443,        798]
NotebookOptionsPosition[     22539,        706]
NotebookOutlinePosition[     22943,        722]
CellTagsIndexPosition[     22900,        719]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Computations on unrestricted case", "Title"],
 "\n",
 StyleBox["Set (and simplify) conditions", "Section"]
}], "Text",
 CellChangeTimes->{{3.8563438419037137`*^9, 
  3.8563438460952044`*^9}},ExpressionUUID->"eb04a10f-08cb-430e-b223-\
fef026ff4a8b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r11", "=", " ", 
  RowBox[{
   RowBox[{"N1", "/", "N"}], " ", "-", " ", "r01"}]}]], "Input",
 CellChangeTimes->{{3.856241055409762*^9, 3.8562410574112105`*^9}, {
  3.8562410945331097`*^9, 3.8562411481989813`*^9}, {3.8562413942892437`*^9, 
  3.8562413985865993`*^9}, {3.8563191337338676`*^9, 3.85631916052186*^9}, {
  3.8563191921179976`*^9, 3.8563192853897457`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"a2d3e9a1-2d98-42bd-bb2c-c44d17fc2dab"],

Cell[BoxData[
 RowBox[{
  FractionBox["N1", "N"], "-", "r01"}]], "Output",
 CellChangeTimes->{{3.856319282238423*^9, 3.8563193164167747`*^9}, 
   3.856319394500353*^9, 3.8563435828124175`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"b30b98d1-4143-439b-8316-29bb18725e8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cond1", " ", "=", " ", 
  RowBox[{
  "r01", "+", "r11", "+", "r02", "+", "r12", "+", "r22", "+", "r03", "+", 
   "r23"}]}]], "Input",
 CellChangeTimes->{{3.8563193231038356`*^9, 3.856319369821841*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"99d893af-5a00-4c24-af45-f1500079b174"],

Cell[BoxData[
 RowBox[{
  FractionBox["N1", "N"], "+", "r02", "+", "r03", "+", "r12", "+", "r22", "+",
   "r23"}]], "Output",
 CellChangeTimes->{{3.856319324104393*^9, 3.856319396685215*^9}, 
   3.856343582848322*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"e9e7d85c-6fc7-4dbd-9560-1444d425076f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "r01", "+", "r11", "+", "r02", "+", "r12", "+", "r22", "+", "r03", "+", 
     "r23"}], "==", "1"}], ",", " ", "r23"}], "]"}]], "Input",
 CellChangeTimes->{{3.8563193606853905`*^9, 3.856319448507247*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"fb517641-b73a-4402-b1c2-164642798fd9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r23", "\[Rule]", 
    FractionBox[
     RowBox[{"N", "-", "N1", "-", 
      RowBox[{"N", " ", "r02"}], "-", 
      RowBox[{"N", " ", "r03"}], "-", 
      RowBox[{"N", " ", "r12"}], "-", 
      RowBox[{"N", " ", "r22"}]}], "N"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8563193904111233`*^9, 3.8563194234792233`*^9}, 
   3.856319461161495*^9, 3.8563435828852205`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"b70e3dd3-8d36-4bdf-a296-9aed151bdef3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r23", "=", 
  FractionBox[
   RowBox[{"N", "-", "N1", "-", 
    RowBox[{"N", " ", "r02"}], "-", 
    RowBox[{"N", " ", "r03"}], "-", 
    RowBox[{"N", " ", "r12"}], "-", 
    RowBox[{"N", " ", "r22"}]}], "N"]}]], "Input",
 NumberMarks->False,
 CellLabel->"In[6]:=",ExpressionUUID->"acd0e690-5aee-443b-aebd-0124e63efd84"],

Cell[BoxData[
 FractionBox[
  RowBox[{"N", "-", "N1", "-", 
   RowBox[{"N", " ", "r02"}], "-", 
   RowBox[{"N", " ", "r03"}], "-", 
   RowBox[{"N", " ", "r12"}], "-", 
   RowBox[{"N", " ", "r22"}]}], "N"]], "Output",
 CellChangeTimes->{3.8563195427337713`*^9, 3.8563435829211254`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"37dc6b8d-7c55-48a3-93ed-c04363e8ab67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "r23", "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[7]:=",ExpressionUUID->"ceb1af6b-0a89-4f16-bf0c-652b69c96038"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"N1", "+", 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r02", "+", "r03", "+", "r12", "+", "r22"}], 
      ")"}]}]}], "N"]}]], "Output",
 CellChangeTimes->{3.8563195479993415`*^9, 3.856343582955035*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"6875f54d-1c75-4771-bbdb-451c9e8af625"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"N1", "+", 
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r02", "+", "r03", "+", "r12", "+", "r22"}], 
       ")"}]}]}], "N"]}], "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[8]:=",ExpressionUUID->"d71a7078-393b-4c40-8ffa-d4d572fc0ca8"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox["N1", "N"], "-", "r02", "-", "r03", "-", "r12", "-", 
  "r22"}]], "Output",
 CellChangeTimes->{3.856319588638213*^9, 3.856343582966004*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"6e335b5a-3a99-45da-8d2f-2b22e166d3df"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Define terms to optimise", "Section"],
 "\nNote: ",
 StyleBox["sigma*term1^(-1)/N",
  FontSlant->"Italic"],
 " is the variance of the estimator of effect 1 (analogously ",
 StyleBox["sigma*term2^(-1)/N",
  FontSlant->"Italic"],
 " for effect 2). But since sigma and N are fixed, we simply work on term1 \
and term2 expressions."
}], "Text",
 CellChangeTimes->{3.8563254139076858`*^9, 
  3.856330194530608*^9},ExpressionUUID->"f85fb758-2680-493e-8abd-\
812f54f9c628"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r11", "*", 
     RowBox[{"r01", "/", 
      RowBox[{"(", 
       RowBox[{"r11", "+", "r01"}], ")"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"r12", "*", 
     RowBox[{"r02", "/", 
      RowBox[{"(", 
       RowBox[{"r12", "+", "r02"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8563196766763177`*^9, 3.8563196766783123`*^9}, {
  3.8563197351227026`*^9, 3.8563197362709594`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"ee586c85-8c69-4386-8a33-485c52c80039"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["N1", "N"], "-", "r01"}], ")"}], " ", "r01"}], "N1"], "+", 
  FractionBox[
   RowBox[{"r02", " ", "r12"}], 
   RowBox[{"r02", "+", "r12"}]]}]], "Output",
 CellChangeTimes->{3.856319677931696*^9, 3.8563197370078144`*^9, 
  3.8563435829989166`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"58a93f02-80e1-44aa-8fc9-9968b86ae49d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term2", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r22", "*", 
     RowBox[{"r02", "/", 
      RowBox[{"(", 
       RowBox[{"r22", "+", "r02"}], ")"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"r23", "*", 
     RowBox[{"r03", "/", 
      RowBox[{"(", 
       RowBox[{"r23", "+", "r03"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.856319689666118*^9, 3.8563197162973003`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"6086153c-b7a9-4dbd-9d17-d1a1e8a9178a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"r02", " ", "r22"}], 
   RowBox[{"r02", "+", "r22"}]], "+", 
  FractionBox[
   RowBox[{"r03", " ", 
    RowBox[{"(", 
     RowBox[{"N", "-", "N1", "-", 
      RowBox[{"N", " ", "r02"}], "-", 
      RowBox[{"N", " ", "r03"}], "-", 
      RowBox[{"N", " ", "r12"}], "-", 
      RowBox[{"N", " ", "r22"}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{"r03", "+", 
      FractionBox[
       RowBox[{"N", "-", "N1", "-", 
        RowBox[{"N", " ", "r02"}], "-", 
        RowBox[{"N", " ", "r03"}], "-", 
        RowBox[{"N", " ", "r12"}], "-", 
        RowBox[{"N", " ", "r22"}]}], "N"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.856319754838683*^9, 3.8563435830368166`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"fd9a9bba-f750-44fc-85b3-331e05dddb07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   FractionBox[
    RowBox[{"r03", " ", 
     RowBox[{"(", 
      RowBox[{"N", "-", "N1", "-", 
       RowBox[{"N", " ", "r02"}], "-", 
       RowBox[{"N", " ", "r03"}], "-", 
       RowBox[{"N", " ", "r12"}], "-", 
       RowBox[{"N", " ", "r22"}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{"r03", "+", 
       FractionBox[
        RowBox[{"N", "-", "N1", "-", 
         RowBox[{"N", " ", "r02"}], "-", 
         RowBox[{"N", " ", "r03"}], "-", 
         RowBox[{"N", " ", "r12"}], "-", 
         RowBox[{"N", " ", "r22"}]}], "N"]}], ")"}]}]], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8563201657880077`*^9, 3.8563201694480133`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"37c51a68-f8c7-42ef-b313-b0050e018f62"],

Cell[BoxData[
 FractionBox[
  RowBox[{"r03", " ", 
   RowBox[{"(", 
    RowBox[{"N1", "+", 
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r02", "+", "r03", "+", "r12", "+", "r22"}], 
       ")"}]}]}], ")"}]}], 
  RowBox[{"N1", "+", 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r02", "+", "r12", "+", "r22"}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{3.85632017045776*^9, 3.8563435830727205`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"73d31ba8-7a21-4757-b156-ee8922a512a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term1", "^", 
  RowBox[{"(", 
   RowBox[{"-", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.856322916733235*^9, 3.856322932947348*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"910e7607-0beb-4910-8c77-6fd7d6fcfc3f"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   FractionBox[
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["N1", "N"], "-", "r01"}], ")"}], " ", "r01"}], "N1"], "+", 
   FractionBox[
    RowBox[{"r02", " ", "r12"}], 
    RowBox[{"r02", "+", "r12"}]]}]]], "Output",
 CellChangeTimes->{{3.8563229293405433`*^9, 3.8563229339951797`*^9}, 
   3.856343583104634*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"d7b8ef11-300b-4d60-8d11-43fa0a198710"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term1s", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"term1", "^", 
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.85632294888414*^9, 3.8563229504680653`*^9}, {
  3.8563231551904593`*^9, 3.856323189468077*^9}},
 NumberMarks->False,
 CellLabel->"In[13]:=",ExpressionUUID->"c0b00ead-b6fe-4945-8d93-91156a50f42f"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"r01", "-", 
   FractionBox[
    RowBox[{"N", " ", 
     SuperscriptBox["r01", "2"]}], "N1"], "+", 
   FractionBox[
    RowBox[{"r02", " ", "r12"}], 
    RowBox[{"r02", "+", "r12"}]]}]]], "Output",
 CellChangeTimes->{{3.8563229397265563`*^9, 3.856322951040248*^9}, 
   3.8563231224284143`*^9, {3.8563231656500735`*^9, 3.856323189999647*^9}, 
   3.8563435832751875`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"2a08f9f6-27cd-47e6-9734-cee839238ce2"]
}, Open  ]],

Cell[TextData[StyleBox["\nOptimisation r01 and r02", "Section"]], "Text",
 CellChangeTimes->{{3.856343885523905*^9, 
  3.8563439140805273`*^9}},ExpressionUUID->"aae50192-a373-4dbb-ad32-\
f60acc2128e6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.856343909389827*^9, 
  3.856343910413457*^9}},ExpressionUUID->"c7861150-9ecc-46d1-b37e-\
c94d55c97419"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"term1s", ",", "r02"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.856323176765401*^9, 3.856323267154829*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"324b4b2d-4140-4859-827f-0abcb409c3ef"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["N1", "2"], " ", 
    SuperscriptBox["r12", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"N1", " ", "r01", " ", "r02"}], "+", 
      RowBox[{"N1", " ", 
       RowBox[{"(", 
        RowBox[{"r01", "+", "r02"}], ")"}], " ", "r12"}], "-", 
      RowBox[{"N", " ", 
       SuperscriptBox["r01", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"r02", "+", "r12"}], ")"}]}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.8563232674985456`*^9, 3.8563435834407372`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"f10bea1b-9e6e-4dac-8248-8224e7fc2192"]
}, Open  ]],

Cell["\<\
Note term1^(-1) is a decreasing function with respect to r02.

\
\>", "Text",
 CellChangeTimes->{{3.8563254353300486`*^9, 
  3.8563254564426355`*^9}},ExpressionUUID->"9e118d4c-6589-45e8-b1d0-\
70ede25ed88b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term2s", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"term2", "^", 
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8563234492932796`*^9, 3.8563234597077265`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"e5e0189d-db0d-41d1-9683-cd35d06e8c21"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"r03", "+", 
   FractionBox[
    RowBox[{"r02", " ", "r22"}], 
    RowBox[{"r02", "+", "r22"}]], "+", 
   FractionBox[
    RowBox[{"N", " ", 
     SuperscriptBox["r03", "2"]}], 
    RowBox[{"N1", "+", 
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r02", "+", "r12", "+", "r22"}], 
       ")"}]}]}]]}]]], "Output",
 CellChangeTimes->{3.8563234610605545`*^9, 3.8563435837909603`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"325d8dcd-b0e3-458e-b82a-373eeb09073f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"term2s", ",", "r02"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.8563234732593584`*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"5e88a4f6-582e-4ef8-92a9-fcb4f84130bb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["r22", "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r02", "+", "r22"}], ")"}], "2"]]}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["N", "2"], " ", 
     SuperscriptBox["r03", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1", "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r02", "+", "r12", "+", "r22"}], ")"}]}]}],
       ")"}], "2"]]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"r03", "+", 
     FractionBox[
      RowBox[{"r02", " ", "r22"}], 
      RowBox[{"r02", "+", "r22"}]], "+", 
     FractionBox[
      RowBox[{"N", " ", 
       SuperscriptBox["r03", "2"]}], 
      RowBox[{"N1", "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r02", "+", "r12", "+", "r22"}], 
         ")"}]}]}]]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{3.8563234762009487`*^9, 3.8563435845289855`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"20189c26-10fd-465b-9165-b4a4a5500f6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"term2s", ",", "r02"}], "]"}], "]"}], "==", "0"}], ",", "r02"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.856323482608943*^9, 3.856323494271673*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"f3d2444f-79d8-4d77-8e31-3e775c167e78"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r02", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"r22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "N"}], "+", "N1", "-", 
          RowBox[{"N", " ", "r03"}], "+", 
          RowBox[{"N", " ", "r12"}], "+", 
          RowBox[{"N", " ", "r22"}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "N"}], " ", "r03"}], "+", 
        RowBox[{"N", " ", "r22"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r02", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"r22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "N"}], "+", "N1", "+", 
          RowBox[{"N", " ", "r03"}], "+", 
          RowBox[{"N", " ", "r12"}], "+", 
          RowBox[{"N", " ", "r22"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"N", " ", "r03"}], "+", 
        RowBox[{"N", " ", "r22"}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8563234947715096`*^9, 3.856343584629716*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"3207ff6d-f407-4f2f-b17e-9a692c2a0ebf"]
}, Open  ]],

Cell[TextData[{
 "Note the first solution gives a positive number, while the second a \
negative. (Checked in R based a particular case)\n\nCombine solution r02 with \
",
 StyleBox["term1s:",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8563270127750945`*^9, 3.856327013241971*^9}, {
  3.8563270696174974`*^9, 3.8563270937318726`*^9}, {3.856327340910437*^9, 
  3.856327350951189*^9}, {3.8563274101603584`*^9, 3.8563274210844126`*^9}, {
  3.8563434571017284`*^9, 3.8563434812312827`*^9}, {3.8563435670275574`*^9, 
  3.856343574123474*^9}},ExpressionUUID->"7868069e-580a-4a61-a81b-\
6d7434ddd05d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r02", "=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"r22", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "N"}], "+", "N1", "-", 
       RowBox[{"N", " ", "r03"}], "+", 
       RowBox[{"N", " ", "r12"}], "+", 
       RowBox[{"N", " ", "r22"}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "N"}], " ", "r03"}], "+", 
     RowBox[{"N", " ", "r22"}]}]]}]}]], "Input",
 CellChangeTimes->{{3.856343600010544*^9, 3.8563436030694036`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"b795bc54-2e23-450e-91cd-5ac7a14bdde2"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"r22", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "N"}], "+", "N1", "-", 
      RowBox[{"N", " ", "r03"}], "+", 
      RowBox[{"N", " ", "r12"}], "+", 
      RowBox[{"N", " ", "r22"}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", "N"}], " ", "r03"}], "+", 
    RowBox[{"N", " ", "r22"}]}]]}]], "Output",
 CellChangeTimes->{3.856343604554353*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"9f2baddd-a9a7-4a4f-8d00-02e03ed940e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "term1s", "]"}]], "Input",
 CellChangeTimes->{
  3.8563435776803293`*^9, {3.8563436110355473`*^9, 3.856343615543209*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"d9af851d-cdf0-4652-85bc-fef00088e23c"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"r01", "-", 
   FractionBox[
    RowBox[{"N", " ", 
     SuperscriptBox["r01", "2"]}], "N1"], "+", 
   FractionBox[
    RowBox[{"r12", " ", "r22", " ", 
     RowBox[{"(", 
      RowBox[{"N1", "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "r03", "+", "r12", "+", "r22"}], ")"}]}]}],
       ")"}]}], 
    RowBox[{
     RowBox[{"N1", " ", "r22"}], "+", 
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r03", " ", "r12"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "r03"}], ")"}], " ", "r22"}], "+", 
        SuperscriptBox["r22", "2"]}], ")"}]}]}]]}]]], "Output",
 CellChangeTimes->{{3.8563435846616344`*^9, 3.8563436184573755`*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"997e8be6-a8b7-4710-97af-efb7fb4964ce"]
}, Open  ]],

Cell["Derivative", "Text",
 CellChangeTimes->{{3.856343702721655*^9, 
  3.8563437046564198`*^9}},ExpressionUUID->"f9f6e6a3-5966-425c-ac38-\
eda2bc42ee6e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"term1s", ",", "r01"}], "]"}], "]"}], "==", "0"}], ",", "r01"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.856343645250741*^9, 3.856343649001371*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"698b5587-39a0-4493-be78-5bafb738aa25"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r01", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N1", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", "r03", " ", "r12"}], "-", 
          RowBox[{"N", " ", "r22"}], "+", 
          RowBox[{"N1", " ", "r22"}], "-", 
          RowBox[{"N", " ", "r03", " ", "r22"}], "+", 
          RowBox[{"N", " ", 
           SuperscriptBox["r22", "2"]}]}], ")"}], "2"]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["N", "3"], " ", 
        SuperscriptBox["r03", "2"], " ", 
        SuperscriptBox["r12", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "3"], " ", "r03", " ", "r12", " ", "r22"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "2"], " ", "N1", " ", "r03", " ", "r12", " ", 
        "r22"}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "3"], " ", 
        SuperscriptBox["r03", "2"], " ", "r12", " ", "r22"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["N", "3"], " ", 
        SuperscriptBox["r22", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "2"], " ", "N1", " ", 
        SuperscriptBox["r22", "2"]}], "+", 
       RowBox[{"2", " ", "N", " ", 
        SuperscriptBox["N1", "2"], " ", 
        SuperscriptBox["r22", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "3"], " ", "r03", " ", 
        SuperscriptBox["r22", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "2"], " ", "N1", " ", "r03", " ", 
        SuperscriptBox["r22", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["N", "3"], " ", 
        SuperscriptBox["r03", "2"], " ", 
        SuperscriptBox["r22", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "3"], " ", "r03", " ", "r12", " ", 
        SuperscriptBox["r22", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "3"], " ", 
        SuperscriptBox["r22", "3"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "2"], " ", "N1", " ", 
        SuperscriptBox["r22", "3"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["N", "3"], " ", "r03", " ", 
        SuperscriptBox["r22", "3"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["N", "3"], " ", 
        SuperscriptBox["r22", "4"]}]}], ")"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8563436499643426`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"1ca63bc6-1755-457f-837f-5f2a274f42bb"]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"53da5d6f-dac8-49d9-8f7d-2ea1c29297a1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 275, 7, 111, "Text",ExpressionUUID->"eb04a10f-08cb-430e-b223-fef026ff4a8b"],
Cell[CellGroupData[{
Cell[858, 31, 468, 8, 28, "Input",ExpressionUUID->"a2d3e9a1-2d98-42bd-bb2c-c44d17fc2dab"],
Cell[1329, 41, 270, 5, 48, "Output",ExpressionUUID->"b30b98d1-4143-439b-8316-29bb18725e8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1636, 51, 303, 6, 28, "Input",ExpressionUUID->"99d893af-5a00-4c24-af45-f1500079b174"],
Cell[1942, 59, 295, 6, 48, "Output",ExpressionUUID->"e9e7d85c-6fc7-4dbd-9560-1444d425076f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2274, 70, 359, 8, 28, "Input",ExpressionUUID->"fb517641-b73a-4402-b1c2-164642798fd9"],
Cell[2636, 80, 509, 12, 48, "Output",ExpressionUUID->"b70e3dd3-8d36-4bdf-a296-9aed151bdef3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3182, 97, 344, 9, 45, "Input",ExpressionUUID->"acd0e690-5aee-443b-aebd-0124e63efd84"],
Cell[3529, 108, 362, 8, 48, "Output",ExpressionUUID->"37dc6b8d-7c55-48a3-93ed-c04363e8ab67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3928, 121, 162, 3, 28, "Input",ExpressionUUID->"ceb1af6b-0a89-4f16-bf0c-652b69c96038"],
Cell[4093, 126, 381, 10, 48, "Output",ExpressionUUID->"6875f54d-1c75-4771-bbdb-451c9e8af625"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4511, 141, 375, 11, 45, "Input",ExpressionUUID->"d71a7078-393b-4c40-8ffa-d4d572fc0ca8"],
Cell[4889, 154, 265, 5, 48, "Output",ExpressionUUID->"6e335b5a-3a99-45da-8d2f-2b22e166d3df"]
}, Open  ]],
Cell[5169, 162, 493, 13, 97, "Text",ExpressionUUID->"f85fb758-2680-493e-8abd-812f54f9c628"],
Cell[CellGroupData[{
Cell[5687, 179, 553, 15, 28, "Input",ExpressionUUID->"ee586c85-8c69-4386-8a33-485c52c80039"],
Cell[6243, 196, 435, 12, 55, "Output",ExpressionUUID->"58a93f02-80e1-44aa-8fc9-9968b86ae49d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6715, 213, 499, 14, 28, "Input",ExpressionUUID->"6086153c-b7a9-4dbd-9d17-d1a1e8a9178a"],
Cell[7217, 229, 822, 23, 57, "Output",ExpressionUUID->"fd9a9bba-f750-44fc-85b3-331e05dddb07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8076, 257, 816, 22, 79, "Input",ExpressionUUID->"37c51a68-f8c7-42ef-b313-b0050e018f62"],
Cell[8895, 281, 571, 17, 51, "Output",ExpressionUUID->"73d31ba8-7a21-4757-b156-ee8922a512a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9503, 303, 240, 5, 28, "Input",ExpressionUUID->"910e7607-0beb-4910-8c77-6fd7d6fcfc3f"],
Cell[9746, 310, 468, 13, 67, "Output",ExpressionUUID->"d7b8ef11-300b-4d60-8d11-43fa0a198710"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10251, 328, 395, 9, 28, "Input",ExpressionUUID->"c0b00ead-b6fe-4945-8d93-91156a50f42f"],
Cell[10649, 339, 491, 12, 61, "Output",ExpressionUUID->"2a08f9f6-27cd-47e6-9734-cee839238ce2"]
}, Open  ]],
Cell[11155, 354, 201, 3, 89, "Text",ExpressionUUID->"aae50192-a373-4dbb-ad32-f60acc2128e6"],
Cell[11359, 359, 152, 3, 28, "Input",ExpressionUUID->"c7861150-9ecc-46d1-b37e-c94d55c97419"],
Cell[CellGroupData[{
Cell[11536, 366, 269, 5, 28, "Input",ExpressionUUID->"324b4b2d-4140-4859-827f-0abcb409c3ef"],
Cell[11808, 373, 650, 18, 57, "Output",ExpressionUUID->"f10bea1b-9e6e-4dac-8248-8224e7fc2192"]
}, Open  ]],
Cell[12473, 394, 217, 7, 81, "Text",ExpressionUUID->"9e118d4c-6589-45e8-b1d0-70ede25ed88b"],
Cell[CellGroupData[{
Cell[12715, 405, 326, 7, 28, "Input",ExpressionUUID->"e5e0189d-db0d-41d1-9683-cd35d06e8c21"],
Cell[13044, 414, 551, 16, 63, "Output",ExpressionUUID->"325d8dcd-b0e3-458e-b82a-373eeb09073f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13632, 435, 247, 5, 28, "Input",ExpressionUUID->"5e88a4f6-582e-4ef8-92a9-fcb4f84130bb"],
Cell[13882, 442, 1134, 37, 76, "Output",ExpressionUUID->"20189c26-10fd-465b-9165-b4a4a5500f6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15053, 484, 362, 9, 28, "Input",ExpressionUUID->"f3d2444f-79d8-4d77-8e31-3e775c167e78"],
Cell[15418, 495, 1119, 33, 48, "Output",ExpressionUUID->"3207ff6d-f407-4f2f-b17e-9a692c2a0ebf"]
}, Open  ]],
Cell[16552, 531, 607, 12, 81, "Text",ExpressionUUID->"7868069e-580a-4a61-a81b-6d7434ddd05d"],
Cell[CellGroupData[{
Cell[17184, 547, 565, 16, 45, "Input",ExpressionUUID->"b795bc54-2e23-450e-91cd-5ac7a14bdde2"],
Cell[17752, 565, 503, 15, 48, "Output",ExpressionUUID->"9f2baddd-a9a7-4a4f-8d00-02e03ed940e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18292, 585, 244, 4, 28, "Input",ExpressionUUID->"d9af851d-cdf0-4652-85bc-fef00088e23c"],
Cell[18539, 591, 874, 26, 68, "Output",ExpressionUUID->"997e8be6-a8b7-4710-97af-efb7fb4964ce"]
}, Open  ]],
Cell[19428, 620, 154, 3, 35, "Text",ExpressionUUID->"f9f6e6a3-5966-425c-ac38-eda2bc42ee6e"],
Cell[CellGroupData[{
Cell[19607, 627, 362, 9, 28, "Input",ExpressionUUID->"698b5587-39a0-4493-be78-5bafb738aa25"],
Cell[19972, 638, 2551, 65, 57, "Output",ExpressionUUID->"1ca63bc6-1755-457f-837f-5f2a274f42bb"]
}, Open  ]]
}
]
*)

