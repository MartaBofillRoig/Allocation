(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24690,        623]
NotebookOptionsPosition[     20737,        546]
NotebookOutlinePosition[     21226,        563]
CellTagsIndexPosition[     21183,        560]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Computations on case 4 simplified\n", "Title"],
 StyleBox["Fixed sample size per period and equal allocations between arms \
within periods and r01=r03", "Subtitle"],
 "\n\n\n",
 StyleBox["Set (and simplify) conditions", "Section"]
}], "Text",
 CellChangeTimes->{{3.8563248189079075`*^9, 3.8563248504343576`*^9}, 
   3.8563248902348986`*^9, {3.856330074429706*^9, 3.856330078818722*^9}, 
   3.8563370227953105`*^9, {3.8563372343766155`*^9, 3.8563372366380224`*^9}, {
   3.8563453867999697`*^9, 3.8563453869555535`*^9}, 3.8564100206668825`*^9, 
   3.8564105079017525`*^9, {3.856411067108614*^9, 3.8564110955135775`*^9}, {
   3.856432699738326*^9, 
   3.8564328154279795`*^9}},ExpressionUUID->"f7ba8136-f710-4688-b231-\
5d7e388e68b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r11", "=", "r01"}]], "Input",
 CellChangeTimes->{{3.856413530669279*^9, 3.8564135331482277`*^9}, 
   3.856431078717802*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"d6340a74-0d80-4548-9830-39c22c183863"],

Cell[BoxData["r01"], "Output",
 CellChangeTimes->{3.8564135608234024`*^9, 3.8564138798819222`*^9, 
  3.8564139324007206`*^9, 3.856414027727558*^9, 3.856414357513543*^9, 
  3.8564149087807407`*^9, 3.856420407220311*^9, 3.8564207064195976`*^9, 
  3.856427988196808*^9, 3.8564292831635113`*^9, 3.856431080413724*^9, 
  3.8564311432540236`*^9, 3.8564312295190964`*^9, 3.8564314334252357`*^9, 
  3.8564326240102696`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"36758763-fdd6-4c80-aca2-34df1dfcfe1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r22", "=", "r12"}]], "Input",
 CellChangeTimes->{{3.8564104979518843`*^9, 3.856410503136069*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"50568765-1735-4a4b-80aa-8a8fa0884893"],

Cell[BoxData["r12"], "Output",
 CellChangeTimes->{3.8564105114699907`*^9, 3.8564135709623327`*^9, 
  3.856413879956072*^9, 3.85641393247552*^9, 3.856414027794715*^9, 
  3.8564143575594196`*^9, 3.8564149088625064`*^9, 3.8564204072971044`*^9, 
  3.8564207065056477`*^9, 3.8564279934835734`*^9, 3.8564292831944284`*^9, 
  3.8564310815596085`*^9, 3.85643114446165*^9, 3.8564312345448074`*^9, 
  3.8564314381346664`*^9, 3.856432628756003*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"8f4a5752-bb33-44e9-ac1a-6f87f8e2c7ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r23", "=", "r03"}]], "Input",
 CellChangeTimes->{{3.8564135477974997`*^9, 3.85641355399035*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"add76c81-0aac-41a3-be6f-44f8314b9ae8"],

Cell[BoxData["r03"], "Output",
 CellChangeTimes->{3.856413573462545*^9, 3.8564138799986887`*^9, 
  3.856413932483499*^9, 3.856414027827633*^9, 3.856414357600312*^9, 
  3.8564149088726015`*^9, 3.856420407334008*^9, 3.856420706558505*^9, 
  3.856427995243841*^9, 3.856429283200413*^9, 3.856431082743991*^9, 
  3.8564311451220427`*^9, 3.8564312348382845`*^9, 3.856431438427883*^9, 
  3.8564326290652514`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"ff3fc221-5126-4a1a-b65f-c7bb3d448648"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r03", "=", "r01"}]], "Input",
 CellChangeTimes->{{3.8564311253194113`*^9, 3.8564311293833895`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"e7d0bb36-b66d-45fb-b665-abdba033d63a"],

Cell[BoxData["r01"], "Output",
 CellChangeTimes->{3.8564311461850996`*^9, 3.8564312357647076`*^9, 
  3.856431438481739*^9, 3.8564326290766635`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"56e3261b-e878-47f4-9a70-1d6180432514"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cond1", " ", "=", " ", 
  RowBox[{
  "r01", "+", "r11", "+", "r02", "+", "r12", "+", "r22", "+", "r03", "+", 
   "r23"}]}]], "Input",
 CellChangeTimes->{{3.8563193231038356`*^9, 3.856319369821841*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"99d893af-5a00-4c24-af45-f1500079b174"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", "r01"}], "+", "r02", "+", 
  RowBox[{"2", " ", "r12"}]}]], "Output",
 CellChangeTimes->{{3.856319324104393*^9, 3.856319396685215*^9}, 
   3.85632780794596*^9, 3.856328262601755*^9, 3.8563295850453415`*^9, 
   3.8563296671917343`*^9, 3.8563297428267703`*^9, 3.856336319727244*^9, 
   3.856336417947386*^9, 3.856336500309127*^9, 3.8563373030197544`*^9, 
   3.856344706882645*^9, 3.856344899585953*^9, 3.85634541970846*^9, 
   3.856345559321079*^9, 3.8563468673399267`*^9, 3.8563479343541145`*^9, 
   3.8563489780884953`*^9, 3.856349261102609*^9, 3.856349313944792*^9, 
   3.856349527306779*^9, 3.8563496122925143`*^9, 3.856349877879943*^9, 
   3.8563499794447985`*^9, 3.8563503624490657`*^9, 3.856350709308073*^9, 
   3.856350859136342*^9, 3.8564087197536664`*^9, 3.8564087794175887`*^9, 
   3.856408930915208*^9, 3.856410027795066*^9, 3.856410316134655*^9, 
   3.8564105115049*^9, 3.8564135759086857`*^9, 3.856413880037738*^9, 
   3.856413932525388*^9, 3.85641402786653*^9, 3.8564143576082897`*^9, 
   3.8564149089119534`*^9, 3.8564204073439784`*^9, 3.856420706618346*^9, 
   3.8564279972472663`*^9, 3.856429283226343*^9, 3.8564310912289305`*^9, 
   3.856431147809507*^9, 3.856431236858203*^9, 3.856431438535596*^9, 
   3.8564326291066904`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"bac74adf-cd84-40cf-b585-8e353ecbbbff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "r01", "+", "r11", "+", "r02", "+", "r12", "+", "r22", "+", "r03", "+", 
     "r23"}], "==", "1"}], ",", " ", "r12"}], "]"}]], "Input",
 CellChangeTimes->{{3.8563193606853905`*^9, 3.856319448507247*^9}, 
   3.8564135883270254`*^9, {3.856431180472969*^9, 3.8564311805318637`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"fb517641-b73a-4402-b1c2-164642798fd9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r12", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"4", " ", "r01"}], "-", "r02"}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8563193904111233`*^9, 3.8563194234792233`*^9}, 
   3.856319461161495*^9, 3.856327809925342*^9, 3.856328263762572*^9, 
   3.856329586277425*^9, 3.856329667225765*^9, 3.8563297439886403`*^9, 
   3.8563363197699327`*^9, 3.856336418025689*^9, 3.8563365003629894`*^9, 
   3.856337303054364*^9, 3.856344706927528*^9, 3.8563448996105404`*^9, 
   3.8563454218534584`*^9, 3.856345561397071*^9, 3.856346868292382*^9, 
   3.856347936617715*^9, 3.856348992180699*^9, 3.856349261153467*^9, 
   3.856349313987678*^9, 3.8563495304730797`*^9, 3.856349612332406*^9, 
   3.856349879422922*^9, 3.8563499794869823`*^9, 3.8563503624780016`*^9, 
   3.8563507093419833`*^9, 3.8563508591742477`*^9, 3.856408719807516*^9, 
   3.856408779470459*^9, 3.8564089309570975`*^9, 3.8564100301686215`*^9, 
   3.8564103161745567`*^9, 3.856410511544792*^9, 3.8564135898573213`*^9, 
   3.856413880179887*^9, 3.856413932562289*^9, 3.8564140279034348`*^9, 
   3.856414357649396*^9, 3.8564149089552464`*^9, 3.856420407390855*^9, 
   3.8564207066784935`*^9, 3.8564279995151997`*^9, 3.856429283254315*^9, 
   3.856431093308073*^9, 3.8564311492764626`*^9, {3.8564311814140472`*^9, 
   3.85643120385635*^9}, 3.856431238109274*^9, 3.8564314385859704`*^9, 
   3.8564326291445265`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"536094e6-f064-4f3a-8c4a-2c35f4987de1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r12", "=", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"4", " ", "r01"}], "-", "r02"}], ")"}]}]}]], "Input",
 NumberMarks->False,
 CellLabel->"In[7]:=",ExpressionUUID->"80178ebf-72e1-4e0a-8ced-4c86a2fd9e2a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"4", " ", "r01"}], "-", "r02"}], ")"}]}]], "Output",
 CellChangeTimes->{3.85643120592165*^9, 3.8564312468526773`*^9, 
  3.856431438592951*^9, 3.856432629151507*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"ccae0f65-f9f9-433c-92f6-d7236fd1e29a"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Define terms to optimise", "Section"],
 "\nNote: ",
 StyleBox["sigma*term1^(-1)/N",
  FontSlant->"Italic"],
 " is the variance of the estimator of effect 1 (analogously ",
 StyleBox["sigma*term2^(-1)/N",
  FontSlant->"Italic"],
 " for effect 2). But since sigma and N are fixed, we simply work on term1 \
and term2 expressions."
}], "Text",
 CellChangeTimes->{{3.856324859103889*^9, 3.8563248655216613`*^9}, {
   3.8563249258313665`*^9, 3.8563250321024923`*^9}, {3.856325108777877*^9, 
   3.856325130602702*^9}, 
   3.8563302435635047`*^9},ExpressionUUID->"54ff16e6-289c-48e2-962e-\
d9bff39fa4b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r11", "*", 
     RowBox[{"r01", "/", 
      RowBox[{"(", 
       RowBox[{"r11", "+", "r01"}], ")"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"r12", "*", 
     RowBox[{"r02", "/", 
      RowBox[{"(", 
       RowBox[{"r12", "+", "r02"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8563246032441535`*^9, 3.856324603752307*^9}, {
   3.856324922372285*^9, 3.856324923755909*^9}, 3.856325158114187*^9, 
   3.856349004221649*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"c76aa63c-8ff6-4e2d-a363-ca301193fbd0"],

Cell[BoxData[
 RowBox[{
  FractionBox["r01", "2"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"4", " ", "r01"}], "-", "r02"}], ")"}], " ", "r02"}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"4", " ", "r01"}], "-", "r02"}], ")"}]}], "+", "r02"}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBWL3+NXTYna/cWTKunkSRJd4tufHAul1e7IrQPTWk1kt
ILpA7c/2BCA9eanbERCdkdx/DkS33HtqlAik96UnXkgB0l0nKl+A6H73cttU
IG0YMvE+iG62TQ5KA9JHCvNTQXTS9qcvQfSDR8s504F0YamjAIiesyZRB0Sz
CPSaguiZ5+eFg+gp1YXJIDq3PnAyiJYqWbcPRD8oTr8IomeV/hVsAdL/04sk
QfSFFYk6INr7qN4uEM3xtu0miJ5y79NHEB1RrVTaBqQbTDimg+iz9ZPngujW
svqVIFpKZPslEL3MZKF4O5AuUn5/rBNITywPfwOiZWwranuBdFpUpkwfkF79
zJy3H0jbPfQTAtEBi65oguiqHUv3gWgAm+3GtQ==
  "],
 CellLabel->"Out[8]=",ExpressionUUID->"e2788ce4-ab6a-47a4-858e-7feab5dc0a25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term2", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r22", "*", 
     RowBox[{"r02", "/", 
      RowBox[{"(", 
       RowBox[{"r22", "+", "r02"}], ")"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"r23", "*", 
     RowBox[{"r03", "/", 
      RowBox[{"(", 
       RowBox[{"r23", "+", "r03"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8563234492932796`*^9, 3.8563234597077265`*^9}, 
   3.8563246019802523`*^9, 3.8563251634446735`*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"e5e0189d-db0d-41d1-9683-cd35d06e8c21"],

Cell[BoxData[
 RowBox[{
  FractionBox["r01", "2"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"4", " ", "r01"}], "-", "r02"}], ")"}], " ", "r02"}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"4", " ", "r01"}], "-", "r02"}], ")"}]}], "+", "r02"}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAeLUyOYZMbvfOIZ5CZwC0TP+nM2PBdKhIrkVIPp8z7IW
EK1W8Wd7ApA+wu9+BET7NUw4B6K9vjwzSgTS4QzJF1KAdNai6hcgWvGYnH0q
kHaIFX8Aott+7w1JA+kvDU4D0Yuim16B6HOHV3OmA+ktR90EQHSWu7MuiA47
OtEURO95kxMBoqMcy5JB9D/z0MkgesGnTftAdNnX7IsgOu8to1ALkP5kViEJ
og88TtMB0Rc8J+4G0VqlPTdBtM/m7x9BdFuIcUUbkA5cyzkdRB+rnzYXRD/b
3rQSRNu93nkJRP8rXSLeDqTdNnw61gmkb3VEvQHRc3Il63tB8qxZMn0geyaW
C/UD6Vk9NzVB9K61y/aBaADmeMXw
  "],
 CellLabel->"Out[9]=",ExpressionUUID->"bd681714-3bfa-424f-b677-18955aba0811"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"term1", "-", "term2"}], "==", "0"}], ",", " ", "r01"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8563483806790066`*^9, 3.8563483877046413`*^9}, {
   3.8563484699124584`*^9, 3.856348471200195*^9}, 3.8563494947550044`*^9, 
   3.8563498206824617`*^9, {3.8563499104000106`*^9, 3.856349921422456*^9}, {
   3.8564280470658884`*^9, 3.8564280497347727`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"2d4643e8-cff6-4c74-b64b-987392fca3f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.856348388342924*^9, 3.8563484722793007`*^9, 3.8563491204630604`*^9, 
   3.8563491734175158`*^9, {3.8563492616305666`*^9, 3.856349275001956*^9}, 
   3.8563493146110954`*^9, 3.856349495572208*^9, 3.85634955260188*^9, 
   3.856349612935319*^9, {3.8563498987607956`*^9, 3.856349922131175*^9}, 
   3.8563499801258507`*^9, 3.8563503630590177`*^9, 3.8563507099377537`*^9, 
   3.8563508597331624`*^9, 3.8564087203283997`*^9, 3.8564087801681194`*^9, 
   3.856408931569378*^9, 3.8564100901152306`*^9, 3.8564103166935945`*^9, 
   3.8564105119271383`*^9, 3.856413642135373*^9, 3.856413880367887*^9, 
   3.856413932895583*^9, 3.856414028312335*^9, 3.856414358006441*^9, 
   3.8564149093269024`*^9, 3.856420407901574*^9, 3.8564207070831547`*^9, {
   3.8564280472284536`*^9, 3.8564280515575347`*^9}, 3.85642928334016*^9, 
   3.8564312535933566`*^9, 3.85643143889215*^9, 3.856432629216935*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"8ffa93d7-c363-4158-b764-4ee842cef1b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", "term1", "]"}]}]], "Input",
 CellChangeTimes->{{3.856348850272216*^9, 3.856348886952399*^9}, {
  3.856349342473493*^9, 3.8563493820966396`*^9}, {3.856349586306259*^9, 
  3.856349586424836*^9}, {3.85640873610672*^9, 3.85640874274086*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3de74555-070f-46af-9774-57e5702cdb57"],

Cell[BoxData[
 FractionBox[
  RowBox[{"r01", "-", 
   RowBox[{"4", " ", 
    SuperscriptBox["r01", "2"]}], "-", 
   RowBox[{"7", " ", "r01", " ", "r02"}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r02"}], ")"}], " ", "r02"}]}], 
  RowBox[{"2", "-", 
   RowBox[{"8", " ", "r01"}], "+", 
   RowBox[{"2", " ", "r02"}]}]]], "Output",
 CellChangeTimes->{
  3.856348860276346*^9, 3.8563492618704643`*^9, {3.8563493148301134`*^9, 
   3.8563493827060204`*^9}, 3.856349613086917*^9, {3.856349980381685*^9, 
   3.856350000310815*^9}, 3.8563503631737127`*^9, 3.8563507100863953`*^9, 
   3.856350859838914*^9, {3.8564087203755465`*^9, 3.8564087440957327`*^9}, 
   3.8564087803795586`*^9, 3.8564089317688804`*^9, 3.856410115591767*^9, 
   3.856410317167329*^9, 3.856410512476668*^9, 3.8564136561398087`*^9, 
   3.8564138804215565`*^9, 3.8564139329663935`*^9, 3.8564140284190493`*^9, 
   3.856414358080243*^9, 3.8564149094276323`*^9, 3.8564204079933314`*^9, 
   3.856420707269161*^9, 3.856428065038072*^9, 3.8564292833830447`*^9, {
   3.8564312664977417`*^9, 3.8564312710742407`*^9}, 3.8564314389021225`*^9, 
   3.8564326293243027`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"4249f2ef-0c0b-46c3-8665-ecfc26536749"]
}, Open  ]],

Cell[TextData[StyleBox["Optimisation ", "Section"]], "Text",
 CellChangeTimes->{{3.856350047151461*^9, 3.8563500610795546`*^9}, 
   3.8564326729081917`*^9},ExpressionUUID->"240d5aee-7b2e-4419-a1c0-\
f371a8e1289d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"1", "/", "term"}], " ", ",", "r02"}], "]"}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{
  3.856428091345325*^9, {3.856428173420972*^9, 3.856428186083642*^9}, {
   3.856428282431139*^9, 3.856428305492283*^9}, {3.856428469976755*^9, 
   3.856428479409972*^9}, {3.8564286628515415`*^9, 3.856428663991213*^9}, {
   3.8564292249654326`*^9, 3.856429228931429*^9}, 3.856429260123062*^9, {
   3.856429483010601*^9, 3.8564294852400775`*^9}, {3.8564295446271334`*^9, 
   3.8564295493492966`*^9}, 3.8564313012547097`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"757f464a-95a6-45f3-b681-937613125f5c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox["r01", "2"]}], "-", 
     RowBox[{"8", " ", "r01", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r02"}], ")"}]}], "+", 
     RowBox[{"r02", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "r02"}], ")"}]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox["r01", "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r02"}], ")"}], " ", "r02"}], "+", 
     RowBox[{"r01", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"7", " ", "r02"}]}], ")"}]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.8564292834169607`*^9, {3.8564295452285557`*^9, 3.8564295509475603`*^9}, 
   3.856429802263921*^9, {3.8564312940068073`*^9, 3.8564313018719325`*^9}, 
   3.856431438984968*^9, 3.8564326293902817`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"cf79b73d-f0c1-405c-b284-d5bac3cafe89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"1", "/", "term"}], " ", ",", "r02"}], "]"}], "]"}], " ", "==",
      "0"}], ",", "r02"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8564295540172577`*^9, 3.8564295651480494`*^9}, 
   3.856429649490012*^9, {3.8564296999448824`*^9, 3.856429706897087*^9}, {
   3.8564313112260923`*^9, 3.8564313311883516`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"6f850a9a-7850-47b6-9c40-4476e79ba188"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r02", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"4", " ", "r01"}], "-", 
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{"8", " ", "r01"}], "+", 
         RowBox[{"16", " ", 
          SuperscriptBox["r01", "2"]}]}]]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r02", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"4", " ", "r01"}], "+", 
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{"8", " ", "r01"}], "+", 
         RowBox[{"16", " ", 
          SuperscriptBox["r01", "2"]}]}]]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8564295657908745`*^9, 3.856429707327159*^9, {3.856431318739788*^9, 
   3.856431331712834*^9}, 3.8564314390517883`*^9, 3.856432629421414*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"9ab90f69-c924-4677-a048-7ada6faa5d80"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "/.", 
  RowBox[{"r01", "->", "0"}]}]], "Input",
 CellChangeTimes->{{3.8564313334575996`*^9, 3.8564313411536627`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"191365d3-e2ac-4651-beab-1b35a3f91c0f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r02", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      SqrtBox["2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r02", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SqrtBox["2"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8564313416207933`*^9, 3.8564314390617604`*^9, 
  3.8564326294584665`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"441a4e7d-6592-486d-b378-cc107c20a2e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"r02", "/", "r12"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r02", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", 
     RowBox[{"r01", "->", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8564315732273827`*^9, 3.8564316381718283`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"4b66706c-ab51-44c6-8cdc-171aa8ac33e5"],

Cell[BoxData[
 SqrtBox["2"]], "Output",
 CellChangeTimes->{{3.8564315868495064`*^9, 3.8564316389459205`*^9}, 
   3.8564326294915648`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"956c8db8-9ba4-4bcd-98cc-1ad54eddfcc9"]
}, Open  ]]
},
WindowSize->{718.5, 771.},
WindowMargins->{{Automatic, -4.2000000000000455`}, {607.8, Automatic}},
TaggingRules-><|"SlideshowSettings" -> <|"Toolbar" -> True|>|>,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f0e268da-d53c-49a2-9de8-3342c94e72bd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 759, 14, 287, "Text",ExpressionUUID->"f7ba8136-f710-4688-b231-5d7e388e68b5"],
Cell[CellGroupData[{
Cell[1342, 38, 225, 4, 28, "Input",ExpressionUUID->"d6340a74-0d80-4548-9830-39c22c183863"],
Cell[1570, 44, 493, 7, 32, "Output",ExpressionUUID->"36758763-fdd6-4c80-aca2-34df1dfcfe1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2100, 56, 199, 3, 28, "Input",ExpressionUUID->"50568765-1735-4a4b-80aa-8a8fa0884893"],
Cell[2302, 61, 515, 7, 32, "Output",ExpressionUUID->"8f4a5752-bb33-44e9-ac1a-6f87f8e2c7ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2854, 73, 198, 3, 28, "Input",ExpressionUUID->"add76c81-0aac-41a3-be6f-44f8314b9ae8"],
Cell[3055, 78, 483, 7, 32, "Output",ExpressionUUID->"ff3fc221-5126-4a1a-b65f-c7bb3d448648"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3575, 90, 201, 3, 28, "Input",ExpressionUUID->"e7d0bb36-b66d-45fb-b665-abdba033d63a"],
Cell[3779, 95, 225, 3, 32, "Output",ExpressionUUID->"56e3261b-e878-47f4-9a70-1d6180432514"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4041, 103, 303, 6, 28, "Input",ExpressionUUID->"99d893af-5a00-4c24-af45-f1500079b174"],
Cell[4347, 111, 1365, 21, 32, "Output",ExpressionUUID->"bac74adf-cd84-40cf-b585-8e353ecbbbff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5749, 137, 435, 9, 28, "Input",ExpressionUUID->"fb517641-b73a-4402-b1c2-164642798fd9"],
Cell[6187, 148, 1591, 28, 48, "Output",ExpressionUUID->"536094e6-f064-4f3a-8c4a-2c35f4987de1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7815, 181, 284, 8, 45, "Input",ExpressionUUID->"80178ebf-72e1-4e0a-8ced-4c86a2fd9e2a"],
Cell[8102, 191, 347, 8, 48, "Output",ExpressionUUID->"ccae0f65-f9f9-433c-92f6-d7236fd1e29a"]
}, Open  ]],
Cell[8464, 202, 624, 15, 120, "Text",ExpressionUUID->"54ff16e6-289c-48e2-962e-d9bff39fa4b2"],
Cell[CellGroupData[{
Cell[9113, 221, 596, 16, 28, "Input",ExpressionUUID->"c76aa63c-8ff6-4e2d-a363-ca301193fbd0"],
Cell[9712, 239, 977, 26, 57, "Output",ExpressionUUID->"e2788ce4-ab6a-47a4-858e-7feab5dc0a25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10726, 270, 552, 15, 28, "Input",ExpressionUUID->"e5e0189d-db0d-41d1-9683-cd35d06e8c21"],
Cell[11281, 287, 965, 26, 57, "Output",ExpressionUUID->"bd681714-3bfa-424f-b677-18955aba0811"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12283, 318, 533, 11, 28, "Input",ExpressionUUID->"2d4643e8-cff6-4c74-b64b-987392fca3f4"],
Cell[12819, 331, 1049, 16, 32, "Output",ExpressionUUID->"8ffa93d7-c363-4158-b764-4ee842cef1b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13905, 352, 394, 6, 28, "Input",ExpressionUUID->"3de74555-070f-46af-9774-57e5702cdb57"],
Cell[14302, 360, 1251, 25, 50, "Output",ExpressionUUID->"4249f2ef-0c0b-46c3-8665-ecfc26536749"]
}, Open  ]],
Cell[15568, 388, 213, 3, 51, "Text",ExpressionUUID->"240d5aee-7b2e-4419-a1c0-f371a8e1289d"],
Cell[CellGroupData[{
Cell[15806, 395, 698, 14, 28, "Input",ExpressionUUID->"757f464a-95a6-45f3-b681-937613125f5c"],
Cell[16507, 411, 1120, 33, 59, "Output",ExpressionUUID->"cf79b73d-f0c1-405c-b284-d5bac3cafe89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17664, 449, 564, 13, 28, "Input",ExpressionUUID->"6f850a9a-7850-47b6-9c40-4476e79ba188"],
Cell[18231, 464, 999, 30, 41, "Output",ExpressionUUID->"9ab90f69-c924-4677-a048-7ada6faa5d80"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19267, 499, 232, 4, 28, "Input",ExpressionUUID->"191365d3-e2ac-4651-beab-1b35a3f91c0f"],
Cell[19502, 505, 489, 15, 36, "Output",ExpressionUUID->"441a4e7d-6592-486d-b378-cc107c20a2e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20028, 525, 474, 12, 28, "Input",ExpressionUUID->"4b66706c-ab51-44c6-8cdc-171aa8ac33e5"],
Cell[20505, 539, 216, 4, 33, "Output",ExpressionUUID->"956c8db8-9ba4-4bcd-98cc-1ad54eddfcc9"]
}, Open  ]]
}
]
*)

